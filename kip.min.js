window.KIP||(window.KIP={Objects:{},Functions:{},Constants:{},Globals:{},Options:{},Test:{},Events:{}});try{KIP.Events.CSSChange=new Event("csschange")}catch(a){console.log("No event")}
KIP.Functions.CreateSimpleElement=function(a,b,c,d,e){var f,g,h;f=document.createElement("div");a&&f.setAttribute("id",a);b&&f.setAttribute("class",b);c&&(f.innerHTML=c);for(g in d)d.hasOwnProperty(g)&&d[g]&&(d[g].key?f.setAttribute(d[g].key,d[g].val):f.setAttribute(g,d[g]));for(h in e)e.hasOwnProperty(h)&&(e[h].setAttribute?f.appendChild(e[h]):(a=KIP.Functions.CreateElement(e[h]),f.appendChild(a)));return f};
KIP.Functions.CreateElement=function(a){var b,c,d;b=document.createElement(a.type||"div");a.id&&b.setAttribute("id",a.id);a.cls&&b.setAttribute("class",a.cls);a.before_content&&(b.innerHTML=a.before_content);a.content&&(b.innerHTML+=a.content);for(c in a.attr)a.attr.hasOwnProperty(c)&&a.attr[c]&&(a.attr[c].key?b.setAttribute(a.attr[c].key,a.attr[c].val):b.setAttribute(c,a.attr[c]));for(d in a.children)a.children.hasOwnProperty(d)&&a.children[d]&&(a.children[d].setAttribute?b.appendChild(a.children[d]):
(c=KIP.Functions.CreateElement(a.children[d]),b.appendChild(c)));a.after_content&&(b.innerHTML+=a.after_content);return b};KIP.Functions.AddCSSClass=function(a,b){var c;a&&b&&(a.Draw&&(a=a.div),KIP.Events.CSSChange&&a.dispatchEvent(KIP.Events.CSSChange),(c=a.getAttribute("class"))?(c=" "+c+" ",-1===c.indexOf(" "+b+" ")&&a.setAttribute("class",KIP.Functions.Trim(c+b))):a.setAttribute("class",b))};
KIP.Functions.RemoveCSSClass=function(a,b){var c,d;a&&b&&(a.Draw&&(a=a.div),KIP.Events.CSSChange&&a.dispatchEvent(KIP.Events.CSSChange),c=" "+a.getAttribute("class")+" ",d=c.length,c=c.replace(" "+b+" "," "),c.length!==d&&a.setAttribute("class",KIP.Functions.Trim(c)))};KIP.Functions.HasCSSClass=function(a,b){if(a)return a.Draw&&(a=a.div),-1===(" "+a.getAttribute("class")+" ").indexOf(" "+b+" ")?!1:!0};
KIP.Functions.SetCSSAttribute=function(a,b,c,d){var e,f,g;for(f=0;f<document.styleSheets.length;f+=1)if(e=document.all?"rules":"cssRules",g=document.styleSheets[f][e])for(e=0;e<g.length;e+=1)if(g[e].selectorText===a&&(g[e].style[b]||d))return g[e].style[b]=c,!0;return!1};
KIP.Functions.GetCSSAttribute=function(a,b){var c,d,e;for(d=0;d<document.styleSheets.length;d+=1)if(c=document.all?"rules":"cssRules",e=document.styleSheets[d][c])for(c=0;c<e.length;c+=1)if(e[c].selectorText===a)return e[c].style[b];return""};
KIP.Functions.CreateCSSClass=function(a,b,c){var d,e;d=document.getElementsByTagName("style");0<d.length?d=d[0]:(d=document.createElement("style"),d.innerHTML="");d.innerHTML+="\n"+a+" {\n";for(e in b)b.hasOwnProperty(e)&&(d.innerHTML=b[e].key?d.innerHTML+("\t"+b[e].key+": "+b[e].val+";\n"):d.innerHTML+("\t"+e+" : "+b[e]+";\n"));d.innerHTML+="\n}";c||document.head.appendChild(d);return d};
KIP.Functions.GetComputedStyle=function(a,b){var c;if(window.getComputedStyle)return c=window.getComputedStyle(a),b?c.getPropertyValue(b):c;if(a.currentStyle)return c=a.currentStyle,b?c[b]:c};KIP.Functions.GlobalOffsetLeft=function(a,b){return KIP.Functions.auxGlobalOffset(a,"offsetLeft",b)};KIP.Functions.GlobalOffsetTop=function(a,b){return KIP.Functions.auxGlobalOffset(a,"offsetTop",b)};
KIP.Functions.GlobalOffsets=function(a,b){return{left:KIP.Functions.GlobalOffsetLeft(a,b),top:KIP.Functions.GlobalOffsetTop(a,b)}};KIP.Functions.auxGlobalOffset=function(a,b,c){for(var d=0;a&&a!==c;)a[b]&&(d+=a[b]),a=a.parentNode;return d};KIP.Functions.FindCommonParent=function(a,b){var c,d;if(a&&b)for(c=a,d=b;c;){for(;d;){if(c===d)return c;d=d.parentNode}c=c.parentNode;d=b}};
KIP.Functions.MoveRelToElem=function(a,b,c,d,e){var f;b=KIP.Functions.GlobalOffsets(a);f=KIP.Functions.GlobalOffsets(a);c=f.left+c-b.left;d=f.top+d-b.top;e||(a.style.position="absolute",a.style.left=c+"px",a.style.top=d+"px");return{x:c,y:d}};KIP.Functions.RemoveSubclassFromAllElements=function(a,b,c){var d,e;a=document.getElementsByClassName(a);for(d=0;d<a.length;d+=1)e=a[d],e!==c&&KIP.Functions.RemoveCSSClass(e,b)};
KIP.Functions.AddResizingElement=function(a,b,c,d){var e,f;KIP.Globals.Resizables||(KIP.Globals.Resizables=[]);e=KIP.Globals.Resizables.length;KIP.Globals.Resizables[e]={o_x:KIP.Functions.GlobalOffsetLeft(a),o_y:KIP.Functions.GlobalOffsetTop(a),o_w:a.offsetWidth,o_h:a.offsetHeight,g_w:c||window.innerWidth,g_h:d||window.innerWidth*b||window.innerHeight,h_w_ratio:b||1,elem:a};f=KIP.Globals.Resizables[e];window.addEventListener("resize",function(){KIP.Functions.ResizeElement(f)});return e};
KIP.Functions.ResizeElement=function(a){var b,c,d,e;d=window.innerWidth/a.g_w;c=a.h_w_ratio*window.innerWidth||window.innerHeight;e=c/a.g_h;b=a.o_x/a.g_w;a.elem.style.left=b*window.innerWidth+"px";b=a.o_y/a.g_h;a.elem.style.top=b*c+"px";a.elem.style.width=a.o_w*d+"px";a.elem.style.height=a.o_h*e+"px"};KIP.Functions.RemoveElemFromArr=function(a,b,c){var d;c||(c=function(a,b){return a===b});for(d=a.length-1;0<=d;--d)c(a[d],b)&&a.splice(d,1)};
KIP.Functions.RoundToPlace=function(a,b){return Math.round(a*b)/b};KIP.Functions.TransitionToDisplayNone=function(a,b,c){c||(c="block");a.addEventListener("transitionend",function(){b()&&(a.style.display="none")});a.addEventListener("csschangestart",function(){b()&&(a.style.display=c)})};KIP.Functions.IsChildEventTarget=function(a,b){return KIP.Functions.IsChild(b,a.target)};KIP.Functions.IsChild=function(a,b,c){for(;b;){if(b===a)return!0;b=b.parentNode}return!1};
KIP.Functions.AppendChildren=function(a){var b;for(b=1;b<arguments.length;b+=1)a.appendChild(arguments[b])};KIP.Functions.CreateTable=function(a,b,c,d,e){var f,g,h,k;d||(d=c.length);a=KIP.Functions.CreateElement({type:"table",cls:b});for(h=0;h<d;h+=1)for(e||(e=c[h].length),b=a.insertRow(-1),k=0;k<e;k+=1)g=c[h][k],f=b.insertCell(-1),this.ProcessCellContents(g,f);return a};
KIP.Functions.ProcessCellContents=function(a,b){var c,d;if(a.toLowerCase)b.innerHTML=a;else if(a.appendChild)b.appendChild(a);else for(d in a.create?(c=KIP.Functions.CreateElement(a.create),b.appendChild(c)):b.innerHTML=a.content,a.attr)a.attr.hasOwnProperty(d)&&b.setAttribute(d,a.attr[d]);return b};
KIP.Functions.AddRow=function(a,b,c,d){var e,f;c||0===c||(c=-1);d||0===d||(d=b.length);if(a&&a.insertRow){a=a.insertRow(c);for(e=0;e<d;e+=1)c=a.insertCell(-1),f=b[e]||"",this.ProcessCellContents(f,c);return a}};KIP.Functions.CombineObjects=function(a,b,c){var d,e,f;d={};f=function(a,b){for(var d in a)a.hasOwnProperty(d)&&(c&&"object"===typeof a[d]?(e={},e.prototype=Object.create(a[d].prototype),e=KIP.Functions.CombineObjects(e,a[d]),b[d]=e):b[d]=a[d])};f(a,d);f(b,d);return d};KIP.Functions.DateDiff=function(a,b,c,d,e){d||(a.setHours(0),a.setMilliseconds(0),a.setMinutes(0),a.setSeconds(0),b.setHours(0),b.setMilliseconds(0),b.setMinutes(0),b.setSeconds(0));a=a>b||c?a-b:b-a;d||(a=Math.floor(a/864E5));e&&(a+=864E5*(0>a?-1:1));return a};KIP.Functions.GetToday=function(a){var b;b=new Date;if(a)return b;b.setHours(0);b.setMilliseconds(0);b.setMinutes(0);b.setSeconds(0);return b};
KIP.Functions.BusinessDateDiff=function(a,b,c,d,e){b=KIP.Functions.DateDiff(a,b,c,d,e);c=0>b?-1:1;a=a.getDay();e=b;for(d=0;d<Math.abs(b);d+=1){if(0===a||6===a)e-=1*c;a+=d*c;a%=7}return e};KIP.Functions.ShortDate=function(a){var b;b=parseInt(a.getFullYear())%100;return a.getMonth()+1+"/"+a.getDate()+"/"+b};KIP.Functions.InputDateFmt=function(a){var b,c;a.getFullYear();b=a.getMonth()+1;10>b&&(b="0"+b);c=parseInt(a.getDate(),10);10>c&&(c="0"+c);return a.getFullYear()+"-"+b+"-"+c};
KIP.Functions.InputToDate=function(a){a=a.split("-");return new Date(+a[0],+a[1]-1,+a[2])};KIP.Functions.ShortTime=function(a,b){var c,d,e;c=parseInt(a.getMinutes());d=parseInt(a.getHours());e="";10>c&&(c="0"+c);b&&(e=" AM",12<=d&&(e=" PM"),12<d&&(d-=12));return d+":"+c+e};KIP.Functions.ShortDateTime=function(a,b){return KIP.Functions.ShortDate(a)+" "+KIP.Functions.ShortTime(a,b)};
KIP.Functions.StopwatchDisplay=function(a,b,c){var d,e,f;c=Math.floor(a/1E3);a%=1E3;d=Math.floor(c/60);c%=60;e=Math.floor(d/60);d%=60;f=Math.floor(e/24);e%=24;b||(b=KIP.Functions.AddLeadingZeroes(2,String(c),String(d),String(e)),c=b[0],d=b[1],e=b[2]);return f+"D  "+e+":"+d+":"+c+" '"+a};KIP.Functions.AddLeadingZeroes=function(a){var b,c,d,e;e=[];for(b=1;b<arguments.length;b+=1)for(c=arguments[b],d=c.length;d<a;d+=1)e[b-1]="0"+c;return e};
KIP.Functions.AddToDate=function(a,b){b.milliseconds&&a.setMilliseconds(a.getMilliseconds()+b.milliseconds);b.seconds&&a.setSeconds(a.getSeconds()+b.seconds);b.minutes&&a.setMinutes(a.getMinutes()+b.minutes);b.hours&&a.setHours(a.getHours()+b.hours);b.days&&a.setDate(a.getDate()+b.days);return a};
KIP.Functions.GetMonthName=function(a,b){switch(a.getMonth()){case 0:return b?"Jan":"January";case 1:return b?"Feb":"February";case 2:return b?"Mar":"March";case 3:return b?"Apr":"April";case 4:return"May";case 5:return b?"Jun":"June";case 6:return b?"Jul":"July";case 7:return b?"Aug":"August";case 8:return b?"Sept":"September";case 9:return b?"Oct":"October";case 10:return b?"Nov":"November";case 11:return b?"Dec":"December"}return""};
KIP.Functions.GetDayOfWeek=function(a,b){switch(a.getDay()){case 0:return b?"Sun":"Sunday";case 1:return b?"Mon":"Monday";case 2:return b?"Tues":"Tuesday";case 3:return b?"Wed":"Wednesday";case 4:return b?"Thurs":"Thursday";case 5:return b?"Fri":"Friday";case 6:return b?"Sat":"Saturday"}return""};KIP.Functions.Piece=function(a,b,c){var d,e,f;e=-1;f=a.indexOf(b);for(d=0;d<c-1;d+=1)if(e=f,f=a.indexOf(b,f+1),-1===e)return"";return-1===f?a.substr(e+1):a.substring(e+1,f)};KIP.Functions.TitleCase=function(a,b){var c,d,e;b=b||" ";e="";c=a.split(b);for(d=0;d<c.length;d+=1)0!==d&&(e+=b),e+=KIP.Functions.CharAt(c[d],0).toUpperCase(),e+=KIP.Functions.Rest(c[d],1).toLowerCase();return e};
KIP.Functions.SentenceCase=function(a){var b;b=KIP.Functions.CharAt(a,0).toUpperCase();return b+=KIP.Functions.Rest(a,1).toLowerCase()};KIP.Functions.CharAt=function(a,b){return a.substr(b,1)};KIP.Functions.Rest=function(a,b){return a.substring(b,a.length)};KIP.Functions.Trim=function(a){a=a.replace(/^\s*/g,"");return a=a.replace(/\s*?$/g,"")};KIP.Functions.CreateSVG=function(a,b,c,d,e,f){try{if(a||0===a){var g=document.createElementNS("http://www.w3.org/2000/svg","svg");g.setAttribute("id",a);g.setAttribute("width",b||0);g.setAttribute("height",c||0);g.setAttribute("viewBox",d||"0 0 0 0");g.setAttribute("version","1.1");e&&(g.innerHTML=e);f||g.setAttribute("preserveAspectRatio","xMinYMin meet");return g}}catch(h){console.log("Error creating SVG")}};
KIP.Functions.CreateSVGElem=function(a,b){try{var c,d;c=document.createElementNS("http://www.w3.org/2000/svg",a);for(d in b)b.hasOwnProperty(d)&&c.setAttribute(d,b[d]);return c}catch(e){console.log("Error creating SVG element")}};KIP.Constants.HueInterval=22;KIP.Constants.LightInterval=20;KIP.Constants.SaturationInterval=20;KIP.Constants.SaturationLimits={Max:100,Min:20};KIP.Constants.LightnessLimits={Max:80,Min:35};KIP.Constants.HSLPieceEnum={Saturation:0,Lightness:1,Hue:2};
KIP.Functions.GenerateColor=function(a,b){var c;KIP.Globals.UsedColors||(KIP.Globals.UsedColors={});KIP.Globals.ColorObj||(KIP.Globals.ColorObj=new KIP.Objects.Color,KIP.Globals.ColorObj.ParseFromHSLColor("hsl(330, 80%, 50%)"));c=KIP.Globals.ColorObj.GetNextHue(b||0);a&&(KIP.Globals.UsedColors[a]=c);return c};KIP.Functions.GetCurrentColor=function(){KIP.Globals.ColorObj||(KIP.Globals.ColorObj=new KIP.Objects.Color,KIP.Globals.ColorObj.ParseFromHSLColor("hsl(330, 80%, 50%)"));return KIP.Globals.ColorObj.GetCurrentHue()};
KIP.Functions.GetApparentColor=function(a,b,c){var d;d=new KIP.Objects.Color;d.ParseColorString(a,c);d.GetApparentColor(b);return d.HexString()};KIP.Functions.GetComplementaryColor=function(a,b){var c;b=b||45;c=new KIP.Objects.Color;c.ParseColorString(a);c.GetLightness()<b?c.lightness=95:c.lightness=5;c.GenerateRGBValues();return c.RGBAString()};KIP.Functions.HexToRGB=function(a){var b;b=new KIP.Objects.Color;b.ParseFromHexColor(a);return b.RGBString()};
KIP.Functions.HexToRBA=function(a,b){var c;c=new KIP.Objects.Color;c.ParseFromHexColor(a,b);return c.RGBAString()};KIP.Functions.HSLToRGB=function(a){var b;b=new KIP.Objects.Color;b.ParseFromHSLColor(a);return b.RGBString()};KIP.Functions.HSLAToRBGA=function(a,b){var c;c=new KIP.Objects.Color;c.ParseFromHSLColor(a,b);return c.RGBAString()};KIP.Functions.FullHexString=function(a,b){var c,d;b=b||0;c=a.toString(16);if(c.length<b)for(d=0;d<b-c.length;d+=1)c="0"+c;return c};
KIP.Objects.Color=function(a,b,c,d){this.red=a||0;this.green=b||0;this.blue=c||0;this.alpha=d||1};KIP.Objects.Color.prototype.RGBAString=function(){return this.RGBString(!0)};KIP.Objects.Color.prototype.RGBString=function(a){var b;b="rgba("+this.red+", "+this.green+", "+this.blue;a&&(b+=", "+this.alpha);return b+")"};
KIP.Objects.Color.prototype.HSLString=function(a){var b;this.hue||this.GenerateHSLValues();b="hsl("+this.hue+", "+this.saturation+"%, "+this.lightness+"%";a&&(b+=", "+this.alpha);return b+")"};KIP.Objects.Color.prototype.HSLAString=function(){return this.HSLString(!0)};
KIP.Objects.Color.prototype.HexString=function(a){var b;b="#"+KIP.Functions.FullHexString(this.red,2);b+=KIP.Functions.FullHexString(this.green,2);b+=KIP.Functions.FullHexString(this.blue,2);a&&(b+=KIP.Functions.FullHexString(this.alpha,2));return b};
KIP.Objects.Color.prototype.GenerateHSLValues=function(){var a,b,c,d,e,f,g;a=this.red/255;b=this.green/255;c=this.blue/255;f=Math.max(a,b,c);g=Math.min(a,b,c);e=f-g;d=(f+g)/2;f===g?(this.saturation=this.hue=0,this.lightness=Math.round(100*d)):(f===a?(a=(b-c)/e,b<c&&(a+=6)):a=f===b?(c-a)/e+2:(a-b)/e+4,this.hue=Math.round(a/6*3600)/10,this.saturation=Math.round(1E3*(.5<d?e/(2-f-g):e/(f+g)))/10,this.lightness=Math.round(1E3*d)/10,this.startHue||(this.startHue=this.hue,this.startSat=this.saturation,this.startLight=
this.lightness))};
KIP.Objects.Color.prototype.GenerateRGBValues=function(){var a,b,c,d,e;a=this.hue/360;b=this.saturation/100;c=this.lightness/100;if(0===b)return this.red=this.green=this.blue=c,this.red*=255,this.green*=255,this.blue*=255,!0;b=.5>c?c*(1+b):c+b-c*b;c=2*c-b;for(e=-1;1>=e;e+=1)d=a+-e/3,0>d?d+=1:1<d&&--d,d<1/6?this.SetAppropriateColor(e+1,255*(c+6*(b-c)*d)):.5>d?this.SetAppropriateColor(e+1,255*b):d<2/3?this.SetAppropriateColor(e+1,255*(c+(b-c)*(2/3-d)*6)):this.SetAppropriateColor(e+1,255*c)};
KIP.Objects.Color.prototype.ParseFromHexColor=function(a,b){var c,d,e,f;if(!/^#?(?:[0-9A-Fa-f]{3,4}){1,2}$/.test(a))return!1;"#"===KIP.Functions.CharAt(a,0)&&(a=KIP.Functions.Rest(a,1));f=6>a.length?1:2;for(c=0;c<a.length;c+=f)d=a.substr(c,f),1===f&&(d+=d),d=parseInt(d,16),this.SetAppropriateColor(c/f,d),4<c&&(e=!0);e||(this.alpha=b||0);return!0};
KIP.Objects.Color.prototype.ParseFromRGBColor=function(a,b){var c,d;c=/rgb\((?:([0-9]{1-3}), ?){3}\)/;d=/rgba\((?:([0-9]{1-3}), ?){3}, ?([0-9]{0,1}(?:\.[0-9]+)?)\)/;if(c.test(a))c=c.exec(a);else if(d.test(a))c=d.exec(a);else return!1;this.red=c[1];this.green=c[2];this.blue=c[3];if(void 0!==c[4]||void 0!==b)this.alpha=c[4]||b;return!0};
KIP.Objects.Color.prototype.ParseFromHSLColor=function(a,b){var c,d;c=/hsl\(([0-9]{1,3}), ?([0-9]{1,3})%, ?([0-9]{1,3})%\)/;d=/hsla\(([0-9]{1,3}), ?([0-9]{1,3})%, ?([0-9]{1,3})%, ?([0-9]{0,1}(?:\.[0-9]+)?)\)/;if(c.test(a))c=c.exec(a);else if(d.test(a))c=d.exec(a);else return!1;this.hue=Math.round(10*parseFloat(c[1]))/10;this.saturation=Math.round(10*parseFloat(c[2]))/10;this.lightness=Math.round(10*parseFloat(c[3]))/10;if(void 0!==c[4]||void 0!==b)this.alpha=parseFloat(c[4])||b;this.GenerateRGBValues();
return!0};KIP.Objects.Color.prototype.ParseColorString=function(a,b){var c;return(c=this.ParseFromRGBColor(a,b))||(c=this.ParseFromHexColor(a,b))?!0:(c=this.ParseFromHSLColor(a,b))?!0:!1};KIP.Objects.Color.prototype.SetAppropriateColor=function(a,b){b=3>a?Math.min(255,Math.max(0,Math.round(b))):Math.min(1,Math.max(0,b));switch(a){case 0:this.red=b;break;case 1:this.green=b;break;case 2:this.blue=b;break;case 3:this.alpha=b}};
KIP.Objects.Color.prototype.GetNextHue=function(a,b){var c=[],d;this.startHue||this.GenerateHSLValues();c[0]=a;c[1]=(a+1)%3;c[2]=(a+2)%3;for(d=0;d<c.length&&this.RotateAppropriateHSLValue(c[d]);d+=1);this.GenerateRGBValues();return this.HexString(b)};KIP.Objects.Color.prototype.GetCurrentHue=function(a){return this.HexString(a)};
KIP.Objects.Color.prototype.RotateAppropriateHSLValue=function(a){var b,c;switch(a){case KIP.Constants.HSLPieceEnum.Saturation:b=this.RotateSaturation();c=this.startSat;break;case KIP.Constants.HSLPieceEnum.Lightness:b=this.RotateLightness();c=this.startLight;break;case KIP.Constants.HSLPieceEnum.Hue:b=this.RotateHue(),c=this.startHue}return b===c?!0:!1};KIP.Objects.Color.prototype.RotateHue=function(){return this.hue=this.RotateHSLValue(this.hue,KIP.Constants.HueInterval,360)};
KIP.Objects.Color.prototype.RotateSaturation=function(){return this.saturation=this.RotateHSLValue(this.saturation,KIP.Constants.SaturationInterval,100,KIP.Constants.SaturationLimits.Max,KIP.Constants.SaturationLimits.Min)};KIP.Objects.Color.prototype.RotateLightness=function(){return this.lightness=this.RotateHSLValue(this.lightness,KIP.Constants.LightInterval,100,KIP.Constants.LightnessLimits.Max,KIP.Constants.LightnessLimits.Min)};
KIP.Objects.Color.prototype.RotateHSLValue=function(a,b,c,d,e){var f;f=a+=b;f%=c;if(!d||!e&&0!==e)return KIP.Functions.RoundToPlace(f,10);for(;f<e||f>d;)f=a+=b,f%=c;return KIP.Functions.RoundToPlace(f,10)};
KIP.Objects.Color.prototype.GetApparentColor=function(a){var b;if(a.red)b=a;else if(b=new KIP.Objects.Color,!b.ParseColorString(a))return!1;a=1-this.alpha;this.red=Math.round(this.red*this.alpha+b.red*a);this.green=Math.round(this.green*this.alpha+b.green*a);this.blue=Math.round(this.blue*this.alpha+b.blue*a);this.alpha=1;return!0};KIP.Objects.Color.prototype.IsDark=function(){this.hue||this.GenerateHSLValues();return 50>=this.lightness};
KIP.Objects.Color.prototype.IsLight=function(){this.hue||this.GenerateHSLValues();return 50<this.lightness};KIP.Objects.Color.prototype.GetLightness=function(){this.hue||this.GenerateHSLValues();return this.lightness};KIP.Objects.Collection=function(){this.data=[];this.backData={};this.sortedData};KIP.Objects.Collection.prototype.Length=function(){return this.data.length};
KIP.Objects.Collection.prototype.AddElement=function(a,b,c,d){var e,f;if(this.DoesElementExist(a)){if(!d)return-1;this.RemoveElement(a)}b={key:a,value:b};c||0===c?(this.data.splice(c,0,b),e=!0):c=this.data.push(b)-1;this.backData[a]=c;if(e)for(f in this.backData)this.backData.hasOwnProperty(f)&&(e=this.backData[f],e>=c&&f!==a&&(this.backData[f]+=1));return c};
KIP.Objects.Collection.prototype.RemoveElement=function(a,b){var c,d,e;b||0===b||(b=this.GetElementIdx(a));e=this.data.splice(b,1);delete this.backData[a];for(c in this.backData)this.backData.hasOwnProperty(c)&&(d=this.backData[c],d>b&&--this.backData[c]);return{key:a,idx:b,value:e}};KIP.Objects.Collection.prototype.RemoveElementAtIndex=function(a){var b;b=this.GetElementKey(a);return this.RemoveElement(b,a)};
KIP.Objects.Collection.prototype.GetElement=function(a,b){b||0===b||(b=this.GetElementIdx(a));return!b&&0!==b||!this.data[b]&&0!==this.data[b]?null:this.data[b]};KIP.Objects.Collection.prototype.GetElementByIdx=function(a){var b=this.GetElementKey(a);return this.GetElement(b,a)};KIP.Objects.Collection.prototype.GetElementIdx=function(a){return this.backData[a]};KIP.Objects.Collection.prototype.GetElementKey=function(a){var b=this.data[a];return b||0===b?this.data[a].key:null};
KIP.Objects.Collection.prototype.Sort=function(a){this.data=this.data.sort(a);this.ReassignBackData();return this.data};KIP.Objects.Collection.prototype.ReassignBackData=function(){var a,b;for(a=0;a<this.data.length;a+=1)b=this.data[a].key,this.backData[b]=a};KIP.Objects.Collection.prototype.MergeCollection=function(a,b){var c,d,e;for(d=0;d<a.data.length;d+=1)c=a.data[d],this.backData.hasOwnProperty(c)?b||(this.data[this.backData[c]]=a.data[d]):(e=this.data.push(a.data[d]),this.backData[c]=e)};
KIP.Objects.Collection.prototype.Clear=function(){this.data=[];this.backData={}};KIP.Objects.Collection.prototype.GetNextIndex=function(){return this.data.length};KIP.Objects.Collection.prototype.DoesElementExist=function(a){return(a=this.backData[a])||0===a?!!this.data[a]:!1};KIP.Objects.Collection.prototype.Sort=function(a){var b;b=this.data.slice();return this.sortedData=b=b.sort(a)};KIP.Functions.AJAXRequest=function(a,b,c,d,e){var f,g,h;f=!1;try{f=new XMLHttpRequest}catch(k){try{f=new ActiveXObject("Msxml2.XMLHTTP")}catch(l){try{f=new ActiveXObject("Microsoft.XMLHTTP")}catch(m){return!1}}}if(!f)return!1;"function"!==typeof c&&(c=function(){});"function"!==typeof d&&(d=function(){});h="";if("string"!==typeof e){for(g in e)e.hasOwnProperty(g)&&(0<h.length&&(h+="&"),h+=escape(g)+"="+escape(e[g]));e=h}f.onreadystatechange=function(){if(4===f.readyState)return 200===f.status?c(f.responseText):
d(f.responseText)};"GET"===a?f.open("GET",b,!0):"POST"===a&&(f.open("POST",b,!0),f.setRequestHeader("Content-type","application/x-www-form-urlencoded"),f.send(e));return f};KIP.Functions.DrawLine=function(a,b,c,d,e){var f,g;f=KIP.Functions.GetDistance(a,b);b=KIP.Functions.GetAngle(a,b);KIP.Functions.CreateCSSClass(".angledLine",{position:"absolute",height:"1px","transform-origin":"0px 0px"});g=KIP.Functions.CreateSimpleElement("","angledLine");g.style.left=a.x+"px";g.style.top=a.y+"px";g.style.width=f+"px";g.style.transform="rotate("+b+"deg)";c.appendChild(g);d&&(a=KIP.Functions.CreateSimpleElement("","lbl",d),e&&(a.style.transform="rotate("+-1*b+"deg)",a.style.transformOrigin=
"(0, 0)"),g.appendChild(a));return g};KIP.Functions.ConnectElements=function(a,b,c,d){var e,f,g;g=KIP.Functions.FindCommonParent(a,b);e=KIP.Functions.GlobalOffsetLeft(a,g)+a.offsetWidth/2;f=KIP.Functions.GlobalOffsetLeft(b,g)+b.offsetWidth/2;a=KIP.Functions.GlobalOffsetTop(a,g)+a.offsetHeight/2;b=KIP.Functions.GlobalOffsetTop(b,g)+b.offsetHeight/2;return KIP.Functions.DrawLine({x:e,y:a},{x:f,y:b},g,c,d)};KIP.Functions.GetDistance=function(a,b){var c,d;c=a.x-b.x;d=a.y-b.y;return Math.sqrt(c*c+d*d)};
KIP.Functions.GetAngle=function(a,b){var c,d,e,f;c=b.x-a.x;d=b.y-a.y;if(0===c)return 0>d?270:90;if(0===d)return 0>c?180:0;e=0>c?Math.PI:0;f=Math.atan(Math.abs(d)/Math.abs(c));return 180/Math.PI*(f*(0<c*d?1:-1)+e)};KIP.Functions.DegreesToRadians=function(a){return Math.PI*a/180};KIP.Functions.Contained=function(a,b){if(b.bottom||b.top||b.left||b.right){if(a.x<b.left||a.x>b.right||a.y<b.top||a.y>b.bottom)return!1}else if(a.x<b.x||a.x>b.x+b.width||a.y<b.y||a.y>b.y+b.height)return!1;return!0};KIP.Objects.Editable=function(a,b,c,d,e){this.id=a;this.type=b||"text";this.content=c;this.validate=d;this.update=e;this.is_modifying=!1;KIP.Objects.Drawable.call(this,this.id,"editable",this.content);this.CreateElements();this.AddListeners()};KIP.Objects.Editable.prototype=Object.create(KIP.Objects.Drawable.prototype);
KIP.Objects.Editable.prototype.AddListeners=function(){var a=this;this.div.onclick=function(b){a.is_modifying||a.Modify();b.stopPropagation&&b.stopPropagation();null!==b.cancelBubble&&(b.cancelBubble=!0)};window.addEventListener("click",function(b){b.target!==a.div&&a.is_modifying&&a.Save()});this.inputDiv.onkeydown=function(b){13===b.keyCode&&a.is_modifying&&a.Save()}};
KIP.Objects.Editable.prototype.CreateElements=function(){this.inputDiv=KIP.Functions.CreateElement({type:"input",id:this.id+"|input",attr:[{key:"type",val:this.type}]})};KIP.Objects.Editable.prototype.Modify=function(){this.is_modifying=!0;this.inputDiv.value=this.content;this.div.innerHTML="";this.div.appendChild(this.inputDiv);this.inputDiv.select();this.inputDiv.focus()};
KIP.Objects.Editable.prototype.Save=function(){var a;a=this.inputDiv.value;this.div.removeChild(this.inputDiv);this.is_modifying=!1;this.validate&&!this.validate(a)?(this.inputDiv.value=this.content,this.div.innerHTML=this.content):(this.content=a,this.div.innerHTML=a,this.update&&this.update(this.content,this))};KIP.Objects.SVGDrawable=function(a,b){this.div=KIP.Functions.CreateSVG(a);this.elements=[];this.elementsByID=[];this.min_y=this.min_x=1E6;this.viewH=this.viewW=this.viewY=this.viewX=this.max_y=this.max_x=0;this.gutter=1;this.cur_ID=0;this.lineProperty={};this.fillProperty={};this.fontProperty={};this.autoResize=!0;this.zoomAmt=.08;if(!b){this.div.style.cursor="-webkit-grab";var c=this;this.div.addEventListener("wheel",function(a){a=a.deltaY;a=0<a?c.zoomAmt:-1*c.zoomAmt;c.Zoom(a)});this.div.addEventListener("mousedown",
function(a){c.isPanning=!0;c.panX=a.clientX;c.panY=a.clientY;c.div.style.cursor="-webkit-grabbing"});window.addEventListener("mousemove",function(a){var b,f;c.isPanning&&(0>=a.x||a.x>=window.innerWidth-1?(c.isPanning=!1,c.div.style.cursor="-webkit-grab"):0>=a.y||a.y>=window.innerHeight-1?(c.isPanning=!1,c.div.style.cursor="-webkit-grab"):(b=a.clientX-c.panX,f=a.clientY-c.panY,c.div.style.cursor="-webkit-grabbing",c.panX=a.clientX,c.panY=a.clientY,b=(1+-1*c.viewW*b)/c.w,f=(2+-1*c.viewH*f)/c.h,c.Pan(b,
f)))});window.addEventListener("mouseup",function(a){c.isPanning=!1;c.div.style.cursor="-webkit-grab"})}};KIP.Objects.SVGDrawable.prototype=Object.create(KIP.Objects.Drawable.prototype);KIP.Objects.SVGDrawable.prototype.CalculateView=function(){this.viewX=this.min_x;this.viewY=this.min_y;this.viewW=this.max_x-this.min_x;this.viewH=this.max_y-this.min_y;return this.CreateView()};
KIP.Objects.SVGDrawable.prototype.CreateView=function(){this.viewW=0>this.viewW?1:this.viewW;this.viewH=0>this.viewH?1:this.viewH;return this.viewX+" "+this.viewY+" "+this.viewW+" "+this.viewH};KIP.Objects.SVGDrawable.prototype.AddRectangle=function(a,b,c,d,e,f){if(!(!a&&0!==a||!b&&0!==b||0>c||!c&&0!==c||0>d||!d&&0!==d))return this.autoResize&&this.UpdateView(a,b,c,d),e||(e={}),e.x=a,e.y=b,e.height=d,e.width=c,this.AddChild("rect",e,f)};
KIP.Objects.SVGDrawable.prototype.UpdateView=function(a,b,c,d){a<this.min_x&&(this.min_x=a-this.gutter);a+c>this.max_x&&(this.max_x=a+c+this.gutter);b<this.min_y&&(this.min_y=b-this.gutter);b+d>this.max_y&&(this.max_y=b+d+this.gutter);this.view=this.CalculateView();this.div.setAttribute("viewBox",this.view)};
KIP.Objects.SVGDrawable.prototype.AddPath=function(a,b,c){var d,e;if(0!==a.length){b||(b={});b.d="";e=this.AddChild("path",b,c);for(d=0;d<a.length;d+=1)c=a[d],0===d?this.MoveTo(c.x,c.y,e):c.controls?this.CurveTo(c.controls[0],c.controls[1],{x:c.x,y:c.y},e):c.radius?this.ArcTo(c.radius,c.xRotation,c.largeArc,c.sweepFlag,{x:c.x,y:c.y},e):this.LineTo(c.x,c.y,e),this.autoResize&&this.UpdateView(c.x,c.y,0,0);b.noFinish||this.FinishPath(e);return e}};
KIP.Objects.SVGDrawable.prototype.MoveTo=function(a,b,c){var d;d=c.getAttribute("d");c.setAttribute("d",d+("M"+a+" "+b+"\n"));return c};KIP.Objects.SVGDrawable.prototype.LineTo=function(a,b,c){var d;d=c.getAttribute("d");c.setAttribute("d",d+("L "+a+" "+b+"\n"));return c};KIP.Objects.SVGDrawable.prototype.CurveTo=function(a,b,c,d){var e;e=d.getAttribute("d");e+="C "+a.x+" "+a.y+", ";e+=b.x+" "+b.y+", ";e+=c.x+" "+c.y+"\n";d.setAttribute("d",e);return d};
KIP.Objects.SVGDrawable.prototype.ArcTo=function(a,b,c,d,e,f){var g;g=f.getAttribute("d");g+="A "+a.x+" "+a.y;g=g+(" "+b+" "+c+" "+d)+(" "+KIP.Functions.RoundToPlace(e.x,1E3)+" "+KIP.Functions.RoundToPlace(e.y,1E3)+"\n");f.setAttribute("d",g);return f};KIP.Objects.SVGDrawable.prototype.FinishPath=function(a){var b;b=a.getAttribute("d");a.setAttribute("d",b+" Z");return a};
KIP.Objects.SVGDrawable.prototype.AddRegularPolygon=function(a,b,c,d,e,f){var g,h,k,l,m;this.autoResize&&this.UpdateView(a-d,b-d,2*d,2*d);g=KIP.Functions.RoundToPlace(KIP.Functions.DegreesToRadians(360/c),1E3);e||(e={});e.points="";e=this.AddChild("polygon",e,f);f="";for(h=m=0;h<c;h+=1)k=a+KIP.Functions.RoundToPlace(Math.sin(m)*d,10),l=b+KIP.Functions.RoundToPlace(-1*Math.cos(m)*d,10),m+=g,f+=k+","+l+" ";e.setAttribute("points",f);return e};
KIP.Objects.SVGDrawable.prototype.AddRegularStar=function(a,b,c,d,e,f,g){var h,k,l,m,n;n=0;k="";this.autoResize&&this.UpdateView(a-d,b-d,2*d,2*d);h=KIP.Functions.RoundToPlace(KIP.Functions.DegreesToRadians(360/c),1E3);f||(f={});f.points="";f=this.AddChild("polygon",f,g);for(g=0;g<c;g+=1)l=a+KIP.Functions.RoundToPlace(Math.sin(n)*d,10),m=b+KIP.Functions.RoundToPlace(-1*Math.cos(n)*d,10),n+=h/2,k+=l+", "+m+" ",l=a+KIP.Functions.RoundToPlace(Math.sin(n)*e,10),m=b+KIP.Functions.RoundToPlace(-1*Math.cos(n)*
e,10),n+=h/2,k+=l+", "+m+" ";f.setAttribute("points",k);return f};KIP.Objects.SVGDrawable.prototype.AddCircle=function(a,b,c,d,e){this.autoResize&&this.UpdateView(a-c,b-c,2*c,2*c);d||(d={});d.cx=a;d.cy=b;d.r=c;return this.AddChild("circle",d,e)};
KIP.Objects.SVGDrawable.prototype.AddPerfectArc=function(a,b,c,d,e,f,g,h){var k,l,m,n,p;k=parseInt(this.fillProperty.width,10)||1;this.autoResize&&this.UpdateView(a.x-b-k,a.y-b-k,2*(b+k),2*(b+k));n=d-c;k=Math.sin(KIP.Functions.DegreesToRadians(c))*b+a.x;l=-1*Math.cos(KIP.Functions.DegreesToRadians(c))*b+a.y;m=Math.sin(KIP.Functions.DegreesToRadians(d))*b+a.x;d=-1*Math.cos(KIP.Functions.DegreesToRadians(d))*b+a.y;p=parseInt(this.fillProperty.width,10)*Math.sqrt(2)||0;c=KIP.Functions.DegreesToRadians(n+
c);g||(g={});g.d="";g=this.AddChild("path",g,h);l+=-1*Math.cos(c)*p;k+=Math.sin(c)*p;d+=-1*Math.cos(c)*p;m+=Math.sin(c)*p;a.y+=-1*Math.cos(c)*p;a.x+=Math.sin(c)*p;this.MoveTo(k,l,g);this.ArcTo({x:b,y:b},0,180<n?1:0,e,{x:m,y:d},g);if(f)return g;this.LineTo(a.x,a.y,g);this.FinishPath(g);return g};
KIP.Objects.SVGDrawable.prototype.AddChild=function(a,b,c){if(a){b.id||(b.id=this.cur_ID,this.cur_ID+=1);var d=KIP.Functions.CreateSVGElem(a,b);"g"!==a&&this.AssignStyle(d);this.elements[this.elements.length]=d;this.elementsByID[b.id]=d;c?c.appendChild(d):this.div.appendChild(d);return d}};
KIP.Objects.SVGDrawable.prototype.AddText=function(a,b,c,d,e,f,g,h){var k;c=c||0;d=d||0;a&&(a=this.MeasureElem(a),c+=a.x,d+=a.y);e||(e={});e.x=c;e.y=d;h?(k=KIP.Functions.CreateSVGElem("flowPara"),k.innerHTML=b,h.x=e.x,h.y=e.y,a=KIP.Functions.CreateSVGElem("flowRegion"),b=KIP.Functions.CreateSVGElem("rect",h),a.appendChild(b),e=KIP.Functions.CreateSVGElem("flowRoot",{id:e.id}),e.appendChild(a),e.appendChild(k)):(e=KIP.Functions.CreateSVGElem("text",e),e.innerHTML=b);this.AssignStyle(e);a=h||!this.autoResize&&
!f?this.MeasureElem(k):this.MeasureElem(e);f&&(h=f.x*a.width,f=f.y*a.height,d-=f-a.height,e.setAttribute("x",c-(h-0)),e.setAttribute("y",d),a=this.MeasureElem(e));this.autoResize&&this.UpdateView(a.x,a.y,a.width,a.height);g?g.appendChild(e):this.div.appendChild(e);KIP.Functions.AddCSSClass(e,"unselectable");return e};
KIP.Objects.SVGDrawable.prototype.MeasureElem=function(a){var b,c,d;if(a){this.div.parentNode&&(c=a.getBBox());if(c&&(c.x||c.y||c.height||c.width))return c;b=this.parent;d=a.parentNode;b!==document.body&&document.body.appendChild(this.div);this.div.appendChild(a);c=a.getBBox();this.div.removeChild(a);b!==document.body&&(document.body.removeChild(this.div),(this.parent=b)&&this.parent.appendChild(this.div));d&&d.appendChild(a);return c}};
KIP.Objects.SVGDrawable.prototype.Draw=function(a,b,c,d){b===this.w&&c===this.h&&d===this.view||this.AdjustSize(b,c,d);KIP.Objects.Drawable.prototype.Draw.call(this,a)};
KIP.Objects.SVGDrawable.prototype.AssignStyle=function(a){var b,c,d;b={};c=[];this.fillProperty&&this.AssignFillValues(this.fillProperty,a,b);this.lineProperty&&this.AssignStrokeValues(this.lineProperty,a,b);this.fontProperty&&this.AssignFontValues(this.fontProperty,a,b);for(d in b)b.hasOwnProperty(d)&&c.push(d+" : "+b[d]);a.setAttribute("style",c.join(";"))};
KIP.Objects.SVGDrawable.prototype.AssignFontValues=function(a,b,c){if(!a)return b;a.size&&(c["font-size"]=a.size+"px");a.family&&(c["font-family"]=a.family);a.weight&&(c["font-weight"]=a.weight);a.style&&(c["font-style"]=a.style);a.color&&(c.fill=a.color);return b};
KIP.Objects.SVGDrawable.prototype.AssignStrokeValues=function(a,b,c){if(!a||!a.type||"None"===a.type)return c.stroke="None",c["stroke-width"]=0,b;"dashed"===a.type&&(a.dashArray||(a.dashArray="1, 5"),b.setAttribute("stroke-dasharray",a.dashArray));a.color&&(c.stroke=a.color);a.opacity&&(c["stroke-opacity"]=a.opacity);if(a.width||0===a.width)c["stroke-width"]=a.width;a.lineCap&&(c["stroke-linecap"]=a.lineCap);a.lineJoin&&(c["stroke-linejoin"]=a.lineJoin);return b};
KIP.Objects.SVGDrawable.prototype.AssignFillValues=function(a,b,c){if(!a||!a.type||"None"===a.type)return c.fill="None",b;a.color&&(c.fill=a.color);a.opacity&&(c["fill-opacity"]=a.opacity);a.url&&(c.fill="url("+a.url+")");return b};KIP.Objects.SVGDrawable.prototype.AdjustStyle=function(a,b){b||(b=this.elementsByID[a]);b&&this.AssignStyle(b)};KIP.Objects.SVGDrawable.prototype.SetLineProperties=function(a){this.SetProperties(this.lineProperty,a)};
KIP.Objects.SVGDrawable.prototype.SetFillProperties=function(a){this.SetProperties(this.fillProperty,a)};KIP.Objects.SVGDrawable.prototype.SetFontProperties=function(a){this.SetProperties(this.fontProperty,a)};KIP.Objects.SVGDrawable.prototype.SetProperties=function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};
KIP.Objects.SVGDrawable.prototype.AdjustSize=function(a,b,c){var d,e;a&&this.w!==a&&(this.w=a||this.w,this.div.setAttribute("width",this.w));b&&this.h!==b&&(this.h=b||this.h,this.div.setAttribute("height",this.h));b&&!a&&(d=this.max_x-this.min_x,e=this.max_y-this.min_y,this.w=d*this.h/e,this.div.setAttribute("width",this.w));a&&!b&&(d=this.max_x-this.min_x,e=this.max_y-this.min_y,this.h=e*this.w/d,this.div.setAttribute("height",this.h));if(c&&this.view!==c||!this.view)this.view=c||this.CalculateView(),
this.div.setAttribute("viewBox",this.view)};KIP.Objects.SVGDrawable.prototype.GetElement=function(a){return this.elementsByID[a]};KIP.Objects.SVGDrawable.prototype.CreateGroup=function(a,b){return this.AddChild("g",{id:a},b)};KIP.Objects.SVGDrawable.prototype.SetAttribute=function(a,b){this.div.setAttribute(a,b)};KIP.Objects.SVGDrawable.prototype.Clear=function(){var a,b;for(b=this.div.children.length-1;1<=b;--b)a=this.div.children[b],this.div.removeChild(a)};
KIP.Objects.SVGDrawable.prototype.Zoom=function(a){var b,c;b=this.viewW;c=this.viewH;this.viewX-=a*b;this.viewY-=a*c;this.viewW+=2*a*b;this.viewH+=2*a*c;this.view=this.CreateView();this.div.setAttribute("viewBox",this.view)};KIP.Objects.SVGDrawable.prototype.Pan=function(a,b){this.viewX+=a;this.viewY+=b;this.view=this.CreateView();this.div.setAttribute("viewBox",this.view)};
KIP.Objects.SVGDrawable.prototype.CalculateScreenCoordinates=function(a,b,c){var d,e,f;this.parent&&c?(e=KIP.Functions.GlobalOffsetLeft(this.div),f=KIP.Functions.GlobalOffsetTop(this.div)):this.parent?(e=this.parent.offsetLeft,f=this.parent.offsetTop):f=e=0;d=this.w/this.viewW;c=this.h/this.viewH;a=d*(a-this.viewX)+e;b=c*(b-this.viewY)+f;a=Math.floor(a);b=Math.floor(b);return{x:a,y:b}};
KIP.Objects.SVGDrawable.prototype.CalculateSVGCoordinates=function(a,b){var c,d;this.parent?(c=this.parent.offsetLeft,d=this.parent.offsetTop):d=c=0;return{x:this.viewW/this.w*(a-c)+this.viewX,y:this.viewH/this.h*(b-d)+this.viewY}};KIP.Objects.SVGDrawable.prototype.CalculateSVGWidth=function(a){return this.viewW/this.w*a};KIP.Objects.SVGDrawable.prototype.CalculateSVGHeight=function(a){return this.viewH/this.h*a};
KIP.Objects.SVGDrawable.prototype.CalculateScreenWidth=function(a){return this.w/this.viewW*a};KIP.Objects.SVGDrawable.prototype.CalculateScreenHeight=function(a){return this.h/this.viewH*a};
KIP.Objects.SVGDrawable.prototype.CreateGradient=function(a,b,c){var d,e,f,g;this.defs||(this.defs=KIP.Functions.CreateSVGElem("defs"),this.gradients=[],this.div.appendChild(this.defs));g="gradient"+this.gradients.length;if("linear"===a)d=KIP.Functions.CreateSVGElem("linearGradient",{id:g});else if("radial"===a)d=KIP.Functions.CreateSVGElem("radialGradient",{id:g});else return;for(f=0;f<b.length;f+=1)e=KIP.Functions.CreateSVGElem("stop",{id:g+"stop"+f}),e.style.stopColor=b[f].color,e.style.stopOpacity=
b[f].opacity,e.setAttribute("offset",b[f].offset),d.appendChild(e);this.defs.appendChild(d);this.gradients[this.gradients.length]=d;c&&(b="gradient"+this.gradients.length,a=KIP.Functions.CreateSVGElem(a+"Gradient",{id:b}),a.setAttribute("x1",c.startX),a.setAttribute("x2",c.endX),a.setAttribute("y1",c.startY),a.setAttribute("y2",c.endY),a.setAttribute("xlink:href","#"+g),this.defs.appendChild(a),this.gradients[this.gradients.length]=d,g=b);return g};
KIP.Objects.SVGDrawable.prototype.CreatePattern=function(a,b){var c;this.defs||(this.defs=KIP.Functions.CreateSVGElem("defs"),this.patternIDs={},this.div.appendChild(this.defs));"stipple"===a&&(b=b||"stipple",c=this.StipplePattern(10,10,b));this.patternIDs[b]&&this.defs.removeChild(this.patternIDs[b]);this.defs.appendChild(c);this.patternIDs[b]=c;return b};
KIP.Objects.SVGDrawable.prototype.StipplePattern=function(a,b,c){c=KIP.Functions.CreateSVGElem("pattern",{id:c||"stipple",x:0,y:0,height:.25,width:.25});c.setAttribute("patternTransform","translate(0,0) scale(10, 10)");c.setAttribute("patternUnits","userSpaceOnUse");a/=5;b/=5;b=KIP.Functions.CreateSVGElem("circle",{rx:a,ry:b,cx:a/2,cy:b/2});this.AssignStyle(b);c.appendChild(b);return c};
KIP.Objects.SVGDrawable.prototype.RotateElement=function(a,b,c){c||(c=this.MeasureElem(a),c={x:c.x+c.width/2,y:c.y+c.height/2});a.setAttribute("transform","rotate("+b+", "+c.x+", "+c.y+")");return a};
KIP.Objects.SVGDrawable.prototype.AddShape=function(a,b,c){var d;"check"===a?d=this.AddPath([{x:-.15,y:2.95},{x:1,y:4},{x:1.25,y:4},{x:3,y:.25},{x:2.4,y:0},{x:1,y:3},{x:.3,y:2.3}],b,c):"x"===a?d=this.AddPath([{x:.25,y:.6},{x:1,y:0},{x:2,y:1.1},{x:3,y:0},{x:3.75,y:.6},{x:2.66,y:1.75},{x:3.75,y:2.9},{x:3,y:3.5},{x:2,y:2.5},{x:1,y:3.5},{x:.25,y:2.9},{x:1.33,y:1.75}],b,c):"plus"===a&&(d=this.AddPath([{x:2,y:2},{x:2,y:0},{x:3,y:0},{x:3,y:2},{x:5,y:2},{x:5,y:3},{x:3,y:3},{x:3,y:5},{x:2,y:5},{x:2,y:3},{x:0,
y:3},{x:0,y:2}],b,c));return d};KIP.Globals.HoverOffsetEnum={Top:1,TopRightAlign:17,Bottom:2,BottomRightAlign:18,Left:4,LeftBottomAlign:36,Right:8,RightAlign:16,BottomAlign:32,RightBottomAlign:40,"Top-Left":5,"Top-Right":9,"Bottom-Left":6,"Bottom-Right":10,Custom:0};
KIP.Objects.Hoverable=function(a,b,c,d,e,f,g){this.id=a;this.cls="hoverable "+b;this.content=c;this.reference=d;this.offset=e||KIP.Globals.HoverOffsetEnum.Top;this.isSVG=f;this.adjust=g||{x:0,y:0};this.enabled=!1;KIP.Objects.Drawable.call(this,this.id,this.cls,this.content);this.div.style.position="absolute"};KIP.Objects.Hoverable.prototype=Object.create(KIP.Objects.Drawable.prototype);KIP.Objects.Hoverable.prototype.SetEnabled=function(a){this.enabled=a};
KIP.Objects.Hoverable.prototype.Draw=function(a){var b=this;(this.parent=a||this.parent)&&this.enabled&&(this.SetupParent(),this.MoveChild(),KIP.Objects.Drawable.prototype.Draw.call(this,this.parent),this.AdjustChild(),this.nudged=!0,window.setTimeout(function(){b.nudged||(b.NudgeOnscreen(),b.nudged=!0)},0))};
KIP.Objects.Hoverable.prototype.SetupParent=function(){this.parent&&(this.parent.style.position=KIP.Functions.GetComputedStyle(this.parent,"position"),"static"===this.parent.style.position&&(this.parent.style.position="relative"))};
KIP.Objects.Hoverable.prototype.MoveChild=function(){var a,b,c,d;d=c=0;this.offset!==KIP.Globals.HoverOffsetEnum.Custom&&(this.reference||(this.reference=this.parent),this.isSVG?(b=this.reference.getBoundingClientRect(),c=b.left,a=b.right-b.left,b=b.bottom-b.top):(a=this.reference.offsetWidth,b=this.reference.offsetHeight),d=this.offset&KIP.Globals.HoverOffsetEnum.Top?d+-1*b:this.offset&KIP.Globals.HoverOffsetEnum.Bottom?d+b:d+0,c=this.offset&KIP.Globals.HoverOffsetEnum.Left?c+-1*a:this.offset&KIP.Globals.HoverOffsetEnum.Right?
c+a:c+0,this.div.style.left=c+"px",this.div.style.top=d+"px")};
KIP.Objects.Hoverable.prototype.AdjustChild=function(){var a,b,c,d,e,f,g,h;if(this.offset!==KIP.Globals.HoverOffsetEnum.Custom){a=this.div.offsetWidth;b=this.div.offsetHeight;c=this.div.offsetLeft;d=this.div.offsetTop;e=KIP.Functions.GlobalOffsetLeft(this.div);f=KIP.Functions.GlobalOffsetTop(this.div);g=this.parent.offsetWidth;h=this.parent.offsetHeight;this.offset&KIP.Globals.HoverOffsetEnum.Top&&(d=-1*b);this.offset&KIP.Globals.HoverOffsetEnum.RightAlign&&(c=g-a);this.offset&KIP.Globals.HoverOffsetEnum.Left&&
(c=-1*a);this.offset&KIP.Globals.HoverOffsetEnum.BottomAlign&&(d=h-b);0>e+a&&(c=this.reference.offsetWidth);e>window.innerWidth&&(c=-1*a);if(f>window.innerHeight||0>e)d=-1*b,c=0;0>f+b&&(d=this.reference.offsetHeight);KIP.Functions.MoveRelToElem(this.div,this.reference,c+(this.adjust.x||0),d+(this.adjust.y||0))}};
KIP.Objects.Hoverable.prototype.NudgeOnscreen=function(){var a,b,c,d,e,f;this.offset!==KIP.Globals.HoverOffsetEnum.Custom&&(a=this.div.offsetWidth,b=this.div.offsetHeight,c=this.div.offsetLeft,d=this.div.offsetTop,e=KIP.Functions.GlobalOffsetLeft(this.div),f=KIP.Functions.GlobalOffsetTop(this.div),this.offset&KIP.Globals.HoverOffsetEnum.Left||this.offset&KIP.Globals.HoverOffsetEnum.Right||(0>e&&(c+=-1*e),e+a>window.innerWidth&&(c-=e+a-window.innerWidth)),this.offset&KIP.Globals.HoverOffsetEnum.Top||
this.offset&KIP.Globals.HoverOffsetEnum.Bottom||(f+b>window.innerHeight&&(d-=f+b-window.innerHeight),0>f&&(d+=-1*f)),KIP.Functions.MoveRelToElem(this.div,this.reference,c,d))};KIP.Objects.ContextMenu=function(a,b){KIP.Objects.Drawable.call(this,"ctxMenu","ctxMenu");this.options=[];this.xOptions=[];this.target=a||window;this.AddEventListeners();b||this.ApplyStandardStyles()};KIP.Objects.ContextMenu.prototype=Object.create(KIP.Objects.Drawable.prototype);
KIP.Objects.ContextMenu.prototype.AddOption=function(a,b,c){var d,e;d=this.options.length;e={};this.xOptions[a]=d;e.div=KIP.Functions.CreateSimpleElement("opt|"+d,"ctxOption",a);e.div.onclick=b;this.div.appendChild(e.div);e.label=a;e.callback=b;this.options[d]=e;if(c)for(b=0;b<c.length;b+=1)this.AddSubOption(a,c[b].label,c[b].callback);return e};
KIP.Objects.ContextMenu.prototype.AddSubOption=function(a,b,c){var d,e;e=this.options.length;d={};a=this.xOptions[a];if((a=this.options[a])||0===a)return this.xOptions[b]=e,a.subMenu||(a.subMenu=this.BuildSubMenu(a.label,a)),d.label=b,d.callback=c,d.div=KIP.Functions.CreateSimpleElement("opt|"+e,"ctxOption",b),d.div.onclick=c,a.subMenu.appendChild(d.div),this.options[e]=d};
KIP.Objects.ContextMenu.prototype.BuildSubMenu=function(a,b){var c;c=KIP.Functions.CreateSimpleElement("subMenu|"+a,"subMenu");c.style.display="none";b.div.addEventListener("mouseover",function(){c.style.display="block"});b.div.addEventListener("mouseout",function(){c.style.display="none"});b.div.innerHTML+="...";KIP.Functions.AddCSSClass(b.div.parentNode,"fadable");b.div.appendChild(c);return c};
KIP.Objects.ContextMenu.prototype.RemoveOption=function(a){a=this.xOptions[a];this.div.removeChild(this.options[a].div);this.options.splice(a,1)};KIP.Objects.ContextMenu.prototype.ClearOptions=function(){this.options.map(function(a){this.div.removeChild(a.div)});this.options.length=0;this.xOptions.length=0};
KIP.Objects.ContextMenu.prototype.AddEventListeners=function(){var a=this;window.addEventListener("contextmenu",function(){a.Erase()},!0);window.addEventListener("click",function(b){a.Erase()});this.target.addEventListener("mouseup",function(b){a.Erase()});this.target.addEventListener("contextmenu",function(b){var c;a.Erase();if(b.ctrlKey)return!0;b.stopPropagation();b.preventDefault();c=b.clientX;b=b.clientY;a.div.style.left=c+"px";a.div.style.top=b+"px";a.Draw(document.body);c+a.div.offsetWidth>
window.innerWidth&&(c=window.innerWidth-a.div.offsetWidth);b+a.div.offsetHeight>window.innerHeight&&(b=window.innerHeight-a.div.offsetHeight);a.div.style.left=c+"px";a.div.style.top=b+"px";return!1},!1)};
KIP.Objects.ContextMenu.prototype.ApplyStandardStyles=function(){var a;KIP.Globals.CreatedCtxMenuStyles||(a={"background-color":"rgba(60, 60, 60, 1)",color:"#FFF","font-family":'"Calibri Light", Sans-Serif',"box-shadow":"1px 1px 3px 2px rgba(0,0,0,0.1)","font-size":"14px","border-radius":"4px","padding-top":"2px","padding-bottom":"2px",width:"10%",position:"absolute"},KIP.Functions.CreateCSSClass(".ctxMenu",a),a["background-color"]="rgba(40, 40, 40, 0.9)",a.width="100%",a.top="-2px",a["box-shadow"]=
"1px 1px 1px 1px rgba(0,0,0,0.1)",a.left="calc(100% - 1px)",a["border-left"]="1px solid #777",KIP.Functions.CreateCSSClass(".subMenu",a),a["background-color"]="rgba(40, 40, 40, 0.85)",a["border-left"]="1px solid #888",KIP.Functions.CreateCSSClass(".subMenu .subMenu",a),a={padding:"4px 10px",cursor:"pointer",position:"relative"},KIP.Functions.CreateCSSClass(".ctxOption",a),a={"background-color":"#505050",color:"#FFF","border-left":"7px solid #999"},KIP.Functions.CreateCSSClass(".ctxOption:hover",a),
KIP.Globals.CreatedCtxMenuStyles=!0)};KIP.Objects.EventHandler=function(){};KIP.Objects.Flow=function(a,b){};KIP.Objects.Form=function(a,b,c,d,e){this.id=a;this.title=b||"Options";this.tables=[];this.btns=c||[];this.saveCb=d||function(){};this.fields=new KIP.Objects.Collection;this.showOverlay=!e;this.standardStyle=!0;this.themeColor="rgba(0,135,230,1)";KIP.Objects.Drawable.call(this,this.id,"form");this.CreateElements()};KIP.Objects.Form.prototype=Object.create(KIP.Objects.Drawable.prototype);
KIP.Objects.Form.prototype.CreateTitleBar=function(){var a=this;this.titleBar=KIP.Functions.CreateSimpleElement("","titleBar",this.title);this.closeLink=KIP.Functions.CreateSimpleElement(this.id+"-close","close","CLOSE");this.closeLink.addEventListener("click",function(){a.CloseForm()});this.titleBar.appendChild(this.closeLink);this.AppendChild(this.titleBar)};
KIP.Objects.Form.prototype.CreateOverlay=function(){var a=this;this.overlay=KIP.Functions.CreateSimpleElement("","overlay");this.overlay.addEventListener("click",function(){a.CloseForm()});this.AddSibling(this.overlay)};
KIP.Objects.Form.prototype.CreateBtnBar=function(a){var b,c,d;this.btnBar=KIP.Functions.CreateSimpleElement("","btnBar");d=this;b=function(a){var b;b=KIP.Functions.CreateSimpleElement(d.id+"-"+a.id,"btn "+a.cls,a.lbl);a.click&&b.addEventListener("click",a.click);a.color&&(b.style.backgroundColor=a.color);return b};for(c=0;c<this.btns.length;c+=1)a=this.btns[c],"OK"!==a.lbl&&"Accept"!==a.lbl&&"Save"!==a.lbl||a.click||(a.click=function(){d.Save();d.CloseForm()}),"Cancel"!==a.lbl||a.click||(a.click=
function(){d.CloseForm()}),a=b(a),this.btnBar.appendChild(a);this.AppendChild(this.btnBar)};KIP.Objects.Form.prototype.CreateElements=function(){this.CreateOverlay();this.CreateTitleBar();this.CreateContent();this.CreateBtnBar()};KIP.Objects.Form.prototype.CreateContent=function(){var a;a=KIP.Functions.CreateSimpleElement(this.id+"-content","content");this.AppendChild(a);this.content=a};
KIP.Objects.Form.prototype.CreateSection=function(a,b,c){var d,e,f;e=KIP.Functions.CreateSimpleElement(a,"section");b&&(f=KIP.Functions.CreateSimpleElement("","secHeader",b));b=this.tables.length;c=c||1;d=KIP.Functions.CreateTable(a+"-table","columnContainer","",0,c);this.tables[b]={table:d,data:[],colNum:c,rowNum:0,id:a};f&&e.appendChild(f);e.appendChild(d);this.content.appendChild(e);this.currentSection=b};
KIP.Objects.Form.prototype.AddField=function(a,b,c,d,e){e||0===e||(e=c);d&&this.AddElement(d,e);this.AddElement(b,c);b&&this.fields.AddElement(a,{elem:b,id:a});this.div.parentNode&&this.Draw();return b};KIP.Objects.Form.prototype.AddHeader=function(a,b){};
KIP.Objects.Form.prototype.AddElement=function(a,b){var c,d,e,f,g,h,k;b?(b.table||0===b.table||(b.table=this.currentSection),b.table||0===b.table||(b.table=this.tables.length-1),b.column=b.column||0):b={table:this.currentSection||this.tables.length-1,col:0};d=b.table;e=b.col;if(0>d||!this.tables[d])return!1;f=this.tables[d].rowNum;g=this.tables[d].colNum;h=this.tables[d].data;0<f&&h[f-1]&&(c=h[f-1],c.children[e]&&c.children[e].innerHTML||(KIP.Functions.ProcessCellContents(a,c.children[e]),k=!0));
k||(c=[],c[e]=a,c=KIP.Functions.AddRow(this.tables[d].table,c,"",g),f+=1,h.push(c));this.tables[d].rowNum=f;this.tables[d].data=h};KIP.Objects.Form.prototype.AddTextInput=function(a,b,c,d,e){return this.AddInput(a,"text",b,[{key:"placeholder",val:d}],e,"",c,c)};
KIP.Objects.Form.prototype.AddExpandingInput=function(a,b,c,d,e,f,g,h,k,l,m){var n;n=this;b||(b=0);c=this.AddInput(a+"."+b,c||"text",e,f,g,h,d,d);c.addEventListener("keyup",k||function(c){!document.getElementById(a+"."+(b+1))&&0<this.value.length&&n.AddExpandingTextInput(a,b+1,txt,d,ghostTxt,g);this.focus()});c.addEventListener("blur",l||function(){0===this.value.length&&n.RemoveField(this.id+"."+this.subID)});if(m)for(k=0;k<m.length;k+=1)(l=m[k])&&c.addEventListener(l.type,l.func)};
KIP.Objects.Form.prototype.AddExpandingInputTable=function(a,b,c,d,e,f,g,h,k){var l,m,n,p;m=this;n=function(){!document.getElementById(a[0]+"."+(b+1))&&0<this.value.length&&m.AddExpandingInputTable(a,b+1,c,d,e,f,g,h,k);this.focus()};p=function(){var c,d,e;d=!0;for(c=0;c<a.length;c+=1)if(e=m.fields.GetElement(a[c]+"."+b).value,0<e.elem.value.length){d=!1;break}if(d)for(c=0;c<a.length;c+=1)d=a[c]+"."+b,m.RemoveField(d)};for(l=0;l<a.length;l+=1)this.AddExpandingInput(a[l],b,c&&c[l]||"",d&&d[l]||0,e&&
e[l]||"",f&&f[l]||{},g&&g[l]||"",h&&h[l]||"",n,p,k&&k[l])};KIP.Objects.Form.prototype.RemoveField=function(a,b){var c;c=this.fields.GetElement(a).value;if(!c||c.elem.value&&!b)return!1;c.elem.parentNode&&c.elem.parentNode.removeChild(c.elem);this.fields.RemoveElement(a);return!0};
KIP.Objects.Form.prototype.AddInput=function(a,b,c,d,e,f,g,h){var k;"object"===typeof a&&(b=a.type,c=a.value,d=a.attr,e=a.lbl,f=a.cls,g=a.position,h=a.lblPosition,a=a.id);d||(d={});d.type=b;d.value=c;b=KIP.Functions.CreateElement({type:"input",cls:f,id:a,attr:d});e&&(k=KIP.Functions.CreateSimpleElement(a+"lbl","lbl",e));return this.AddField(a,b,g,k,h)};
KIP.Objects.Form.prototype.Save=function(){var a,b,c;c={};for(a=0;a<this.fields.Length();a+=1)b=this.fields.GetElement("",a).value,c[b.id]=b.elem.value;this.saveCb&&this.saveCb(c)};KIP.Objects.Form.prototype.CloseForm=function(){this.overlay.parentNode&&this.overlay.parentNode.removeChild(this.overlay);this.div.parentNode&&this.div.parentNode.removeChild(this.div)};
KIP.Objects.Form.prototype.AfterDrawChildren=function(){this.standardStyle&&!this.stylesCreated&&(this.ApplyStandardStyles(),this.stylesCreated=!0)};
KIP.Objects.Form.prototype.ApplyStandardStyles=function(){var a,b,c;a=KIP.Functions.GetComputedStyle(this.parent,"position");"static"===a&&(a="relative");this.parent.style.position=a;KIP.Functions.CreateCSSClass(".overlay",{position:"fixed",left:0,top:0,width:"100%",height:"100%","background-color":"rgba(0,0,0,0.7)","z-index":"1"});KIP.Functions.CreateCSSClass(".form",{left:"30%",top:"15%","background-color":"#FFF","box-shadow":"1px 1px 13px 4px rgba(0,0,0,.2);","font-family":"Segoe UI, Calibri, sans",
"z-index":"2",position:"absolute",display:"block","max-width":"80%",padding:"10px",width:"40%"});a={"background-color":"rgba(0,0,0,.1)",border:"1px solid rgba(0,0,0,.25)","font-family":"Segoe UI, Calibri, sans"};KIP.Functions.CreateCSSClass(".form input",a);a={width:"250px",outline:"none"};KIP.Functions.CreateCSSClass(".form input[type=text]",a);a={width:"calc(100% - 10px)","text-align":"center","background-color":this.themeColor,color:"#FFF",padding:"5px","font-size":"20px",position:"absolute",top:"-30px",
left:"0px"};KIP.Functions.CreateCSSClass(".form .titleBar",a);a={"float":"right",display:"inline-block",opacity:"0.7","font-size":"15px","padding-top":"2px","padding-right":"5px"};KIP.Functions.CreateCSSClass(".form .titleBar .close",a);a={opacity:"1",cursor:"pointer"};KIP.Functions.CreateCSSClass(".form .titleBar .close:hover",a);a={width:"100%",display:"flex","flex-direction":"row","justify-content":"flex-end","font-size":"20px"};KIP.Functions.CreateCSSClass(".form .btnBar",a);a={padding:"5px",
"box-shadow":"1px 1px 1px 1px rgba(0,0,0,.2)","border-radius":"3px","font-size":"15px",opacity:"0.7",margin:"5px"};KIP.Functions.CreateCSSClass(".form .btnBar .btn",a);a={opacity:"1",cursor:"pointer"};KIP.Functions.CreateCSSClass(".form .btnBar .btn:hover",a);KIP.Functions.CreateCSSClass(".form .lbl",{color:"#666",display:"inline-block","text-align":"right","padding-left":"5px","padding-right":"5px"});KIP.Functions.CreateCSSClass(".form .secHeader",{color:this.themeColor,"font-weight":"bold","font-size":"22px",
"margin-bottom":"10px","margin-top":"10px"});b={display:"table",width:"100%"};KIP.Functions.CreateCSSClass(".form .columnContainer",b);b={display:"table-cell"};KIP.Functions.CreateCSSClass(".form .column",b);for(a=0;a<this.tables.length;a+=1)c=this.tables[a],b=100/c.colNum,b={width:b+"%"},KIP.Functions.CreateCSSClass(".form #"+c.id+" .column",b)};KIP.Constants.GraphTypeEnum={Pie:0,Bar:1,Circle:2,Tier:3,Line:4,Trend:5,Segment:6};KIP.Objects.Graph=function(a,b){this.id=a;this.data=[];this.dataListeners=[];this.type=b;this.sortedData=[];this.units={};this.htmlLbls=[];this.elems=[];this.svg=new KIP.Objects.SVGDrawable(a+"|graph",!0);KIP.Objects.Drawable.call(this,a);this.AppendChild(this.svg)};KIP.Objects.Graph.prototype=Object.create(KIP.Objects.Drawable.prototype);
KIP.Objects.Graph.prototype.SetUnits=function(a,b,c){this.units.x=a||"";this.units.y=b||"";this.units.z=c||""};KIP.Objects.Graph.prototype.AddData=function(a,b,c,d,e){var f;f=this.data.length;this.data[f]={lbl:a,x:b,y:c,z:d,extra:e};this.AddDataAppropriateForGraph(f);return f};KIP.Objects.Graph.prototype.AddDataAppropriateForGraph=function(a){};
KIP.Objects.Graph.prototype.AddListenerToData=function(a,b,c){this.dataListeners[a]||(this.dataListeners[a]=[]);this.dataListeners[a][this.dataListeners[a].length]={type:b,listener:c}};KIP.Objects.Graph.prototype.AttachDataListeners=function(a,b){var c,d,e,f;if(d=this.dataListeners[a])for(f=0;f<d.length;f+=1)d[f]&&(c=d[f].type,e=d[f].listener,c&&e&&b.addEventListener(c,function(){e(this,f)}))};
KIP.Objects.Graph.prototype.AdjustSize=function(a,b,c){var d,e;c=this.svg.AdjustSize(a,b,c);for(b=0;b<this.htmlLbls.length;b+=1)d=this.htmlLbls[b].x,e=this.htmlLbls[b].y,a=this.htmlLbls[b].elem,d=this.svg.CalculateScreenCoordinates(d,e),a.style.left=d.x+"px",a.style.top=d.y+"px";return c};KIP.Objects.Graph.prototype.AddHTMLLbl=function(a,b,c,d){this.htmlLbls.push({elem:a,x:b,y:c,extra:d})};KIP.Objects.CircularGraph=function(a,b){this.useSVGLabels=!1;KIP.Objects.Graph.call(this,a,b)};
KIP.Objects.CircularGraph.prototype=Object.create(KIP.Objects.Graph.prototype);
KIP.Objects.CircularGraph.prototype.AddTextAroundRing=function(a,b,c,d,e,f,g,h,k){var l,m,n;if(this.radius)return e=e||this.radius,l=KIP.Functions.DegreesToRadians(b+(c-b)/2),m=KIP.Functions.RoundToPlace(-1*Math.cos(l),1E3),l=KIP.Functions.RoundToPlace(Math.sin(l),1E3),n={},n.y=m/-4+.75,n.x=l/-2+.5,this.svg.lineProperty.type="none",a=this.svg.AddText(d,a,this.center.x+l*(e+1),this.center.y+(e+1)*m,{id:f,"class":g},n,h),k&&(k=this.svg.MeasureElem(a),a.setAttribute("transform","rotate("+(((c-b)/2+b)%
45+315)+" "+(k.x+k.width/2)+" "+(k.y+k.height/2)+")")),a};KIP.Objects.CircularGraph.prototype.CalculateMiddlePointOfSegment=function(a,b){var c,d,e;e=this.radius;c=KIP.Functions.DegreesToRadians(a+(b-a)/2);d=KIP.Functions.RoundToPlace(-1*Math.cos(c),1E3);c=KIP.Functions.RoundToPlace(Math.sin(c),1E3);c=this.center.x+c*(e+1);d=this.center.y+(e+1)*d;e=this.svg.CalculateScreenCoordinates(c,d);return{svg_x:c,svg_y:d,x:e.x,y:e.y}};
KIP.Objects.CircularGraph.prototype.AddPieceListeners=function(a,b,c){a&&b&&(a.addEventListener("mouseover",function(){b.style.opacity=1;c&&(c.style.opacity=.8)}),a.addEventListener("mouseout",function(){b.style.opacity=0;c&&(c.style.opacity=0)}),b.style.transition="opacity ease-in-out .2s",b.style.opacity=0,c&&(c.style.opacity=0,c.style.transition="opacity ease-in-out .2s"))};
KIP.Objects.PieGraph=function(a,b,c){KIP.Objects.CircularGraph.call(this,a,KIP.Constants.GraphTypeEnum.Pie);this.center=b||{x:80,y:80};this.radius=c||30;this.total=0;this.svg.lineProperty={type:"solid",color:"#000",width:"0px"};this.svg.fontProperty={family:"Segoe UI",size:"10px"};this.svg.fillProperty={type:"solid"};this.hslRotate=KIP.Constants.HSLPieceEnum.Saturation;this.sort=!0;this.days=this.keyY=this.keyX=0;this.addKey=this.addLabels=!0};KIP.Objects.PieGraph.prototype=Object.create(KIP.Objects.CircularGraph.prototype);
KIP.Objects.PieGraph.prototype.ChooseColorRotate=function(a){this.hslRotate=a};KIP.Objects.PieGraph.prototype.GetHoverLabel=function(a){return this.GetKeyLabel(a,!0)};
KIP.Objects.PieGraph.prototype.GetKeyLabel=function(a,b){var c,d;c=this.units.x?" "+this.units.x:"";d="<div style='display: table-cell; ";a.color&&!b?d=d+"padding-left: 5px; border-left: 15px solid; border-color: "+a.color:b||(d+="padding-left: 20px;");d=d+"'>"+a.lbl;d+="</div><div style=' padding-bottom: 5px; display: table-cell; padding-left: 10px;'>";d=a.x?d+(a.x+c):d+"&nbsp;";d+="</div><div style='margin-bottom: 5px; display: table-cell; padding-left: 10px;'>";a.x?a.x!==this.total&&(d+="("+KIP.Functions.RoundToPlace(a.x/
this.total*100,10)+"%)"):d+="&nbsp;";return d+"</div>"};
KIP.Objects.PieGraph.prototype.Refresh=function(){this.svg.Clear();this.div.innerHTML="";this.layers={};this.layers.wedges=this.svg.CreateGroup("wedges");this.layers.boxes=this.svg.CreateGroup("boxes");this.layers.text=this.svg.CreateGroup("text");this.layers.hovers=KIP.Functions.CreateSimpleElement("hoverbubbles","hoverbubbles");this.sortedArray=this.data.slice();this.Sort();this.DrawSegments();this.addKey&&(this.DrawKey({x:"",lbl:""}),this.DrawKey({x:this.total,lbl:"TOTAL"}),this.div.appendChild(this.layers.key));
this.AppendChild(this.layers.hovers)};KIP.Objects.PieGraph.prototype.DrawSegments=function(){var a,b,c,d,e;for(a=d=0;a<this.sortedArray.length;a+=1)b=this.sortedArray[a],e=KIP.Functions.GenerateColor("",this.hslRotate),c=this.DrawSegment(b,e,d),d=c.endDeg,c=c.elem,b.element=c,b.color=e,this.DrawLabels(b),this.addKey&&this.AddDataToKey(b),this.AttachDataListeners(b.id,c)};
KIP.Objects.PieGraph.prototype.DrawSegment=function(a,b,c){var d,e,f,g,h;d=a.id;e=a.x/this.total;f=a.y||this.radius;g=c+360*e;h=this.svg.fillProperty.color;this.svg.fillProperty.color=b;e=1===e?this.svg.AddCircle(this.center.x,this.center.y,f,{},this.layers.wedges):this.svg.AddPerfectArc(this.center,f,c,g,1,!1,{id:d},this.layers.wedges);this.svg.fillProperty.color=h;this.elems[d]={piece:e,label:a.text,color:b};a.elem=e;a.startDeg=c;a.endDeg=g;a.color=b;return a};
KIP.Objects.PieGraph.prototype.DrawKey=function(a){var b;this.layers.key||(this.layers.key=KIP.Functions.CreateSimpleElement(this.id+"|key","graphKey"),this.layers.key.style.position="absolute",this.layers.key.style.display="table",this.layers.key.style.borderCollapse="separate",this.layers.key.style.borderSpacing="5px",this.layers.key.style.left=this.svg.w+50+"px");b=a.color;a=KIP.Functions.CreateSimpleElement("key"+a.id,"keyVal",this.GetKeyLabel(a));a.style.display="table-row";b?(a.style.borderLeft=
"15px solid",a.style.borderColor=b,a.style.paddingLeft="5px"):a.style.paddingLeft="20px";this.layers.key.appendChild(a)};KIP.Objects.PieGraph.prototype.DrawLabels=function(a){this.addLabels&&(this.useSVGLabels?text=this.AddTextAroundRing(datum.lbl,lastDeg,lastDeg+360*perc,elem,r,"","",layerText,this.rotate):this.DrawHoverLabel(a))};
KIP.Objects.PieGraph.prototype.DrawHoverLabel=function(a){var b,c,d,e,f,g,h,k,l;k=this;c=a.element;d=a.ID;e=a.color;l=this.svg.CalculateScreenCoordinates(this.center.x,this.center.y);b=KIP.Functions.CreateSimpleElement(d+"|lbl","segmentLbl",this.GetHoverLabel(a));b.style.border="1px solid";b.style.borderLeft="8px solid";b.style.padding="3px";b.style.borderColor=e;b.style.borderRadius="3px";b.style.boxShadow="1px 1px 5px 2px rgba(0,0,0,.2)";b.style.backgroundColor="#FFF";b.style.position="absolute";
b.style.opacity=0;b.style.display="none";b.style.transition="opacity ease-in-out .2s .05s";c.addEventListener("mouseover",function(c){b.style.display="block";window.setTimeout(function(){var a;a=b.getBoundingClientRect();f<l.x&&(f-=a.right-a.left);g<l.y&&(g-=a.bottom-a.top);g+(a.bottom-a.top)>window.innerHeight&&(g=window.innerHeight-(a.bottom-a.top));KIP.Functions.Contained({x:c.x,y:c.y},a);b.style.left=f+"px";b.style.top=g+"px";b.style.opacity=1},50);(h=k.CalculateMiddlePointOfSegment(a.startDeg,
a.endDeg))?(f=h.x,g=h.y):(f=c.x+"px",g=c.y+"px")});c.addEventListener("mouseout",function(a){b.style.opacity=0;window.setTimeout(function(){b.style.display="none"},250)});this.layers.hovers.appendChild(b)};KIP.Objects.PieGraph.prototype.Sort=function(){this.sort&&(this.sortedArray=this.sortedArray.sort(function(a,b){return a.x>b.x?-1:a.x<b.x?1:0}))};KIP.Objects.PieGraph.prototype.AddDataToKey=function(a,b){this.DrawKey(a)};
KIP.Objects.PieGraph.prototype.AddDataAppropriateForGraph=function(a){var b;b=this.data[a];this.total+=b.x;b.id=a;this.parent&&this.Refresh()};KIP.Objects.CircleGraph=function(a,b,c,d){this.center=b||{x:80,y:80};this.radius=c||30;this.ringTotals=[];this.fillProperty={type:"solid"};this.style=d||{stroke:{type:"solid",color:"#000",width:"5px"},fill:{}};this.fontStyle={font:{family:"Segoe UI",size:"10px"},fill:{type:"solid"}};this.strokeWidth=5;KIP.Objects.CircularGraph.call(this,a,KIP.Constants.GraphTypeEnum.Circle)};
KIP.Objects.CircleGraph.prototype=Object.create(KIP.Objects.CircularGraph.prototype);
KIP.Objects.CircleGraph.prototype.Refresh=function(){var a,b,c,d,e,f,g,h,k,l,m,n,p;n=this.CreateGroup("rings");p=this.CreateGroup("text");d=Math.max.apply(this,this.ringTotals);a={};k=[];for(c=0;c<this.data.length;c+=1)b=this.data[c],a[b.lbl]||(a[b.lbl]=KIP.Functions.GenerateColor(b.lbl,KIP.Constants.HSLPieceEnum.Hue)),e=a[b.lbl],f=b.y,g=b.z*this.strokeWidth,k[f]||(k[f]=0),l=360*b.x/d+k[f],0>f?(f*=-1,m=.4):m=1,h=this.radius+this.radius/2*f,this.style.stroke.width=g+"px",this.style.stroke.color=e,
e=this.AddPerfectArc(this.center,h,k[f],l,1,!0,this.style,"","",n),e.style.opacity=m,b=this.AddTextAroundRing(b.lbl,k[f],l,e,h+(g-this.strokeWidth),"","",p),this.div.appendChild(e),this.AddPieceListeners(e,b),this.AttachDataListeners(c,e),k[f]=l};KIP.Objects.CircleGraph.prototype.AddDataAppropriateForGraph=function(a){var b;b=this.data[a];a=b.y;0>a&&(a*=-1);this.ringTotals[a]||(this.ringTotals[a]=0);this.ringTotals[a]+=b.x;this.parent&&this.Draw()};
KIP.Objects.TrendingGraph=function(a,b,c){this.min_x=b||1E7;this.min_y=c||1E7;this.hslRotate=KIP.Constants.HSLPieceEnum.Hue;this.style={fill:{},stroke:{type:"solid",width:"0.2"},font:{family:"Calibri"}};this.fontStyle={fill:{type:"solid"},font:{family:"Calibri"}};KIP.Objects.Graph.call(this,a,KIP.Constants.GraphTypeEnum.Trend)};KIP.Objects.TrendingGraph.prototype=Object.create(KIP.Objects.Graph.prototype);
KIP.Objects.TrendingGraph.prototype.AddDataAppropriateForGraph=function(a){a=this.data[a];this.UpdateView(a.x,a.y,1,1)};KIP.Objects.TrendingGraph.prototype.AddLineListeners=function(a,b,c){var d=this;a&&b&&(a.addEventListener("mouseover",function(){b.style.opacity=1;a.style.strokeWidth=3*d.style.stroke.width+"px";c&&(c.style.opacity=.8)}),a.addEventListener("mouseout",function(){b.style.opacity=0;a.style.strokeWidth=d.style.stroke.width+"px";c&&(c.style.opacity=0)}),b.style.opacity=0)};
KIP.Objects.TrendingGraph.prototype.Refresh=function(){var a,b,c,d,e,f,g,h;b=this.data.slice();b=b.sort(function(a,b){return a&&b&&void 0!==a.z&&void 0!==b.z?a.z>b.z?1:a.z<b.z?-1:a.x>b.x?1:a.x<b.x?-1:0:0});this.style.stroke.width=Math.min(this.max_x-this.min_x,this.max_y-this.min_y)/70;this.fontStyle.font.size=8*this.style.stroke.width;e=this.CreateGroup("pts");f=this.CreateGroup("txt");for(d=0;d<b.length;d+=1)a=b[d],void 0===a.z&&!g||c!==a.z?(this.fontStyle.fill.color=this.style.stroke.color=KIP.Functions.GenerateColor("",
this.hslRotate),void 0!==a.z&&(c=a.z),g=this.AddChild("path",{d:""},this.style,"","",e),h=this.AddText(g,a.lbl,a.x,a.y,this.fontStyle,"","","",f),this.AddLineListeners(g,h),this.MoveTo(a.x,a.y,g)):this.LineTo(a.x,a.y,g)};
KIP.Objects.SegmentGraph=function(a,b){this.totals={};this.guideLines=[];this.layers={};this.groupsByX={};this.colors={};KIP.Objects.Graph.call(this,a,KIP.Constants.GraphTypeEnum.Segment);this.dataListeners={};this.options={showYAxis:!0,showXAxis:!0,dataWidth:5,dataGap:2,startY:20,startX:0,shadowOffset:{x:.12,y:.07},shadowLayers:5,shadowOpacity:.2,subLbl:""};b&&KIP.Functions.CombineObjects(this.options,b);this.layers.shadows=this.svg.CreateGroup("shadows");this.layers.data=this.svg.CreateGroup("data");
this.layers.axes=this.svg.CreateGroup("axes");this.layers.guidelines=this.svg.CreateGroup("guidelines");this.layers.hoverBubbles=KIP.Functions.CreateSimpleElement("hoverBubbles","hoverBubbles");this.layers.axisLbls=KIP.Functions.CreateSimpleElement("axisLbls","axisLbls");this.AppendChild(this.layers.axisLbls);this.AppendChild(this.layers.hoverBubbles);this.svg.fillProperty.type="solid";this.svg.lineProperty.type="none"};KIP.Objects.SegmentGraph.prototype=Object.create(KIP.Objects.Graph.prototype);
KIP.Objects.SegmentGraph.prototype.AddDataAppropriateForGraph=function(a){var b;b=this.data[a];this.totals[b.x]||(this.totals[b.x]=0);this.groupsByX[b.x]||(this.groupsByX[b.x]={});this.totals[b.x]+=b.y;this.groupsByX[b.x][b.lbl]||(this.groupsByX[b.x][b.lbl]={value:0,idx:[]});this.groupsByX[b.x][b.lbl].value+=b.y;this.groupsByX[b.x][b.lbl].idx.push(a)};
KIP.Objects.SegmentGraph.prototype.AddListenerToData=function(a,b,c,d){this.dataListeners[a]||(this.dataListeners[a]={});this.dataListeners[a][b]||(this.dataListeners[a][b]={});this.dataListeners[a][b][c]={type:c,listener:d}};KIP.Objects.SegmentGraph.prototype.AttachDataListeners=function(a,b,c,d){var e,f;if(c=this.dataListeners[b]&&this.dataListeners[b][c])for(f in c)c.hasOwnProperty(f)&&c[f]&&(b=c[f].type,e=c[f].listener,b&&e&&a.addEventListener(b,function(){e(d)}))};
KIP.Objects.SegmentGraph.prototype.AddGuideline=function(a){this.guideLines.push(a)};KIP.Objects.SegmentGraph.prototype.Refresh=function(){this.DrawData();this.DrawAxes();this.DrawGuidelines()};KIP.Objects.SegmentGraph.prototype.DrawData=function(){var a,b,c;c=this.options.startX;for(a in this.groupsByX)this.groupsByX.hasOwnProperty(a)&&(b=this.groupsByX[a],this.DrawBar({data:b,position:c,x:a}),c+=this.options.dataGap+this.options.dataWidth);this.lastX=c};
KIP.Objects.SegmentGraph.prototype.DrawBar=function(a){var b,c,d,e,f,g,h;d=a.data;e=a.position;g=a.x;h=[];c=this.options.startY;for(b in d)d.hasOwnProperty(b)&&(f=d[b],f.lbl=b,h.push(f));h.sort(function(a,b){return a.value>b.value?-1:a.value<b.value?1:0});for(d=0;d<h.length;d+=1)f=h[d],b=f.lbl,f.startPosition={x:e,y:c},f.x=g,f=this.DrawSegment(f),c=f.endPosition.y;this.DrawShadow(e,c,this.options.dataWidth,this.options.startY-c);this.xAxisLbls||(this.xAxisLbls=[]);this.xAxisLbls.push({x:e,lbl:g});
return a};
KIP.Objects.SegmentGraph.prototype.DrawSegment=function(a){var b,c,d,e,f,g,h;e=a.lbl;this.colors[e]||(this.colors[e]=this.GenerateColor());b=this.svg.fillProperty.color;f=this.svg.lineProperty.type;g=this.svg.lineProperty.color;h=this.svg.lineProperty.width;a.color=this.svg.fillProperty.color=this.colors[e];this.svg.lineProperty.color="rgba(0,0,0,.03)";this.svg.lineProperty.type="solid";this.svg.lineProperty.width=".02";c=a.value;d=a.startPosition.y-c;c=this.svg.AddRectangle(a.startPosition.x,d,this.options.dataWidth,
c,{},this.layers.data);a.endPosition={x:a.startPosition.x+this.options.dataWidth,y:d};a.elem=c;this.DrawLabel(a);this.svg.fillProperty.color=b;this.svg.lineProperty.type=f;this.svg.lineProperty.color=g;this.svg.lineProperty.width=h;this.AttachDataListeners(c,a.x,e,a);return a};
KIP.Objects.SegmentGraph.prototype.DrawLabel=function(a){var b,c;c=a.lbl+" ("+a.value+(this.units.y?" "+this.units.y:"")+")";this.options.subLbl&&(c+="<br>"+this.options.subLbl);b=KIP.Functions.CreateSimpleElement("segmentLbl|"+a.x+"|"+a.lbl,"segmentLbl",c);b.style.position="absolute";b.style.display="none";b.style.border="1px solid";b.style.borderLeft="8px solid";b.style.borderColor=a.color;b.style.padding="5px";b.style.fontFamily='"Segoe UI Light", "Calibri"';b.style.boxShadow="1px 1px 5px 2px rgba(0, 0, 0, .2)";
b.style.transition="opacity ease-in-out .2s";b.style.opacity="0";b.style.borderRadius="5px";b.style.backgroundColor="#FFF";c=this.svg.CalculateScreenCoordinates(a.endPosition.x,a.endPosition.y);b.style.left=c.x+"px";b.style.top=c.y+"px";a.elem.addEventListener("mouseover",function(a){b.style.display="block";window.setTimeout(function(){b.style.opacity=1},50)});a.elem.addEventListener("mouseout",function(){b.style.opacity=0;window.setTimeout(function(){b.style.display="none"},250)});this.layers.hoverBubbles.appendChild(b);
this.AddHTMLLbl(b,a.endPosition.x,a.endPosition.y);a.lblElem=b};
KIP.Objects.SegmentGraph.prototype.DrawShadow=function(a,b,c,d){var e,f,g,h;e=this.svg.fillProperty.color;this.svg.fillProperty.color="#000";this.svg.fillProperty.opacity=this.options.shadowOpacity/this.options.shadowLayers;g=this.options.shadowOffset.x/this.options.shadowLayers;h=this.options.shadowOffset.y/this.options.shadowLayers;for(f=1;f<=this.options.shadowLayers;f+=1)this.svg.AddRectangle(a+g*f,b+h*f,c,d,{},this.layers.shadows);this.svg.fillProperty.color=e;this.svg.fillProperty.opacity=0};
KIP.Objects.SegmentGraph.prototype.DrawAxes=function(){this.options.showXAxis&&this.DrawAxis({type:"horizontal",data:this.xAxisLbls,layer:this.layers.axes});this.options.showYAxis&&this.DrawAxis({type:"vertical"})};
KIP.Objects.SegmentGraph.prototype.DrawAxis=function(a){var b,c,d,e,f,g;c=this.svg.maxX||this.lastX;b=this.svg.minX||this.options.startX;d=this.options.startY+.05;f=this.svg.lineProperty.type;g=this.svg.lineProperty.color;e=this.svg.lineProperty.width;this.svg.lineProperty.type="solid";this.svg.lineProperty.color="#777";this.svg.lineProperty.width=.02;"horizontal"===a.type&&this.svg.AddPath([{x:b,y:d},{x:c,y:d}],{noFinish:!0},a.layer);this.svg.lineProperty.type=f;this.svg.lineProperty.color=g;this.svg.lineProperty.width=
e;if(a.data)for(d+=.8,b=0;b<a.data.length;b+=1)e=a.data[b].lbl,c=a.data[b].x+.35*this.options.dataWidth,e=KIP.Functions.CreateSimpleElement("","axisLbl",e),e.style.position="absolute",e.style.transform="rotate(45deg)",e.style.fontSize="13px",e.style.color="#777",this.layers.axisLbls.appendChild(e),this.AddHTMLLbl(e,c,d)};
KIP.Objects.SegmentGraph.prototype.DrawGuidelines=function(){var a,b,c,d,e,f,g,h,k,l;b=this.svg.lineProperty.type;c=this.svg.lineProperty.color;d=this.svg.lineProperty.width;e=this.svg.lineProperty.dashArray;this.svg.lineProperty.type="dashed";this.svg.lineProperty.color="#333";this.svg.lineProperty.width=.05;this.svg.lineProperty.dashArray="0.05, 0.25";f=this.options.startY;g=this.layers.guidelines;k=this.svg.maxX||this.lastX;h=this.svg.minX||this.options.startX;l=this;this.guideLines.map(function(b){var c;
a=f-b;l.svg.AddPath([{x:h,y:a},{x:k,y:a}],{noFinish:!0},g);c=l.svg.CalculateScreenCoordinates(h,a);l.units.y&&(b+=" "+l.units.y);b=KIP.Functions.CreateSimpleElement("","guideLbl",b);b.style.position="absolute";b.style.fontSize="13px";b.style.color="#777";b.style.left=c.x+15+"px";b.style.top=c.y-22+"px";l.layers.axisLbls.appendChild(b);l.AddHTMLLbl(b,h,a)});this.svg.lineProperty.type=b;this.svg.lineProperty.color=c;this.svg.lineProperty.width=d;this.svg.lineProperty.dashArray=e};
KIP.Objects.SegmentGraph.prototype.GenerateColor=function(a){return KIP.Functions.GenerateColor(a,KIP.Constants.HSLPieceEnum.Hue)};KIP.Objects.ProjectWindow=function(a,b,c,d){this.id=this.name=a;this.rowHeight=5;this.rowSpace=2.5;this.unitWidth=5;this.items=[];this.eventCnt=0;this.rows=[];this.lines=[];this.headers=[];this.itemHeaders=[];this.importantDates={};this.impDateCategories=[];this.showOverallLbl=this.showWeekends=!0;this.disableFill=!1;this.showTitles=!0;this.alwaysShowEvents=!1;this.maxHeaderHeight=40;this.monthColors="37c8ab #00aad4 #0066ff #3737c8 #7137c8 #ab37c8 #ff0066 #ff2a2a #ff6600 #ffcc00 #abc837 #37c837".split(" ");
b.getYear||(b=new Date(b));c.getYear||(c=new Date(c));this.start=b;this.end=c;this.today=new Date;this.relStart=this.ConvertToProjectPoint(b);this.relEnd=this.ConvertToProjectPoint(c);this.relToday=this.ConvertToProjectPoint(this.today);this.bubbleColor="#333";this.textColor="#FFF";d?(this.width=d.width,this.height=d.height):(this.width=window.innerWidth,this.height=window.innerHeight);KIP.Objects.SVGDrawable.call(this,this.id);a=this.Resize();this.autoResize=!1;this.AdjustSize(this.width,this.height,
a);this.barPercentages=[.5,.5];this.bottomBarPercentage=.5;this.barGap=this.bottomBarGap=.05;this.eventRow=0;this.lineGrp=this.CreateGroup("lines");this.itemGrp=this.CreateGroup("items");this.eventGrp=this.CreateGroup("events");this.txtGrp=this.CreateGroup("textBubbles");this.headerGrp=this.CreateGroup("guideHeaders");this.overlayGrp=this.CreateGroup("overlay");this.textDiv=KIP.Functions.CreateSimpleElement("svgText");this.headerDiv=KIP.Functions.CreateSimpleElement("svgHeaders");this.CreateGuidelines();
this.segmentColors=[];this.AddWindowListeners(d)};KIP.Objects.ProjectWindow.prototype=Object.create(KIP.Objects.SVGDrawable.prototype);
KIP.Objects.ProjectWindow.prototype.AddWindowListeners=function(a){var b,c,d;b=window.innerHeight;c=window.innerWidth;d=this;window.addEventListener("resize",function(){var e;a?(d.width=a.width*window.innerWidth/c,d.height=a.height*window.innerHeight/b):(d.width=window.innerWidth,d.height=window.innerHeight);e=d.Resize();d.CreateGuidelines();d.AdjustSize(d.width,d.height,e);d.Draw()})};
KIP.Objects.ProjectWindow.prototype.Resize=function(){var a=this.width/this.height;this.viewH=40*this.rowHeight;this.viewW=40*this.unitWidth*a;this.viewY=this.viewX=0;return this.CreateView()};KIP.Objects.ProjectWindow.prototype.ConvertToProjectPoint=function(a,b,c){b=b||this.start;a=this.showWeekends?KIP.Functions.DateDiff(a,b,!0,c):KIP.Functions.BusinessDateDiff(a,b,!0,c);c&&(a/=864E5);return a};
KIP.Objects.ProjectWindow.prototype.RevertFromProjectPoint=function(a){var b;b=new Date(this.start);this.showWeekends||(a+=2*Math.floor((a+this.start.getDay())/5)+1);b.setDate(b.getDate()+a);return b};KIP.Objects.ProjectWindow.prototype.AddGrouper=function(a){};
KIP.Objects.ProjectWindow.prototype.CreateExpandedInfo=function(a){var b,c;c={TopSegments:!0,BottomSegments:!0,Events:!0,Design:!0,ganttItem:!0};b=KIP.Functions.CreateSimpleElement("","additionalInfo");b.innerHTML=this.expandedInfoCB?this.expandedInfoCB(a):this.WriteArray(a,"<div class='additionalInfoLine'>","</div>",c);return b};
KIP.Objects.ProjectWindow.prototype.WriteArray=function(a,b,c,d){var e,f,g;g="";for(e in a)a.hasOwnProperty(e)&&(f=a[e],d&&d[e]||("object"!==typeof f?g+=b+e+" : "+f+c:f&&(g+=b+e+" : "+this.WriteArray(f,b,c)+c)));return g};
KIP.Objects.ProjectWindow.prototype.AddItem=function(a,b,c,d,e){var f,g,h,k;a.getYear||(a=new Date(a));b.getYear||(b=new Date(b));h=this.ConvertToProjectPoint(a);k=this.ConvertToProjectPoint(b);f=this.items.length;g=this.GetRow(h,k);e=this.items[f]={grp:this.CreateGroup("item"+f,this.itemGrp),lbl:c,row:g,start:a,end:b,x:h*this.unitWidth,y:g*this.rowHeight*this.rowSpace,width:(k-h)*this.unitWidth,id:f,eventGrp:this.CreateGroup(f+"|events",this.eventGrp),addl:e,addlInfoExpanded:this.CreateExpandedInfo(e)};
for(f=0;f<d.length;f+=1)this.CreateSegments(d[f],e,h,k,g,f);e.ctx=this.AddContextMenu(e);this.fillProperty.color="#000";this.fillProperty.opacity=.8;this.fontProperty.size=2*this.rowHeight/3;e.text=this.AddText("",c+"   "+KIP.Functions.ShortDate(a)+" - "+KIP.Functions.ShortDate(b),this.unitWidth/2,-1,"","",e.grp);this.fillProperty.opacity=1;this.showTitles||e.text.parentNode.removeChild(e.text);this.rows[g]||(this.rows[g]=[]);this.rows[g].push(e);return e};
KIP.Objects.ProjectWindow.prototype.AddContextMenu=function(a){var b,c;c=this;b=new KIP.Objects.ContextMenu(a.grp);b.AddOption("Expand/Collapse",function(){c.ExpandItem(a)});b.AddOption("Remove",function(){c.RemoveItem(a)});return b};KIP.Objects.ProjectWindow.prototype.GetRowOfItem=function(a){var b,c;if(a&&a.row)return a.row;for(b=this.rows.length-1;0<=b;b+=1)for(c=0;c<this.rows[b].length;c+=1)if(this.rows[b][c]===a)return b};
KIP.Objects.ProjectWindow.prototype.CreateSegments=function(a,b,c,d,e,f){var g,h,k,l,m;k=c;m=!0;for(g=0;g<a.length;g+=1)a[g]&&(h=a[g].end,h.getYear||(h=new Date(h)),l=this.ConvertToProjectPoint(h),h=k,m?m=!1:h+=.5,l>=k?this.CreateSegment(b,{x:h,y:e},l,a[g],g,f,b):console.log("\nError in segment creation\nStart: "+h+" End: "+l),k=l);this.disableFill||k===d||this.CreateSegment(b,{x:m?c:k+.5,y:e},d,{},-1,f,b)};
KIP.Objects.ProjectWindow.prototype.CreateSegment=function(a,b,c,d,e,f,g){var h,k;h=b.y*this.rowHeight*this.rowSpace;k=this.rowHeight*this.barPercentages[f];if(0<f){for(--f;0<=f;--f)h+=this.rowHeight*this.barPercentages[f]+this.barGap*this.rowHeight;h+=this.barGap*this.rowHeight}f=b.x*this.unitWidth;b=(c-b.x)*this.unitWidth+.5*this.unitWidth;if(0>b||isNaN(b))console.log("Err: improper width for segment");else return this.SetSegmentStyle(d,e),e=this.AddRectangle(f,h,b,k,"",a.grp),d.lbl&&(b=d.lbl,d.type&&
(b+="<br>["+d.type+" on "+d.end+"]"),this.showTitles||(b+="<br><br>"+g.lbl+" ("+KIP.Functions.ShortDate(g.start)+" - "+KIP.Functions.ShortDate(g.end)+")"),this.AddTextBubble(b,e,a,"","","",h+6*k-a.y)),e};KIP.Objects.ProjectWindow.prototype.SetSegmentStyle=function(a,b){this.segmentColors[b]||(this.segmentColors[b]=KIP.Functions.GenerateColor(b,KIP.Constants.HSLPieceEnum.Hue));this.fillProperty.type="solid";this.fillProperty.color=this.segmentColors[b]};
KIP.Objects.ProjectWindow.prototype.AddEventData=function(a,b,c,d){var e,f,g,h,k;if(a){b.getYear||(e=new Date(b));e=this.ConvertToProjectPoint(e,"",!0);g=e*this.unitWidth;f=this.GetRowOfItem(a);h=f*this.rowHeight+(f-1)*this.rowSpace;for(k=this.eventRow-1;0<=k;--k)h+=2*this.barGap*this.rowHeight+this.rowHeight*this.barPercentages[k];b={lbl:c,date:b,prjPt:e,row:f,x:g,y:h,addl:d};a.events||(a.events=[]);a.events.push(b);return b}};
KIP.Objects.ProjectWindow.prototype.AddEvent=function(a,b,c,d,e,f){if(a)return b||(b=this.AddEventData(a,c,d,e)),c=this.unitWidth/8,d=this.rowHeight/(2+this.barPercentages.length),this.fillProperty.type="solid",b.addl?b.addl.idx||0===b.addl.idx?this.fillProperty.color=this.segmentColors[b.addl.idx]:b.addl.color&&(this.fillProperty.color=b.addl.color):this.fillProperty.color="#FFF",this.fillProperty.opacity=.3,e=this.rowHeight*this.barPercentages[this.eventRow],f?(this.lineProperty.type="None",this.lineProperty.width=
0,this.lineProperty.color="rgba(0,0,0,0)",f=this.AddPath([{x:b.x-c,y:b.y-d},{x:b.x-c,y:b.y},{x:b.x,y:b.y+.5*d},{x:b.x+c,y:b.y},{x:b.x+c,y:b.y-d}],{id:"ev."+this.eventCnt},a.eventGrp)):(this.lineProperty.type="solid",this.lineProperty.color="rgba(0,0,0,0)",this.lineProperty.width=this.viewW/250,f=this.AddRectangle(b.x,b.y,this.viewW/1E3,e,{id:"ev."+this.eventCnt},a.eventGrp)),this.AddTextBubble(b.lbl,f,a,"","",.3),this.lineProperty.type="None",this.lineProperty.width=0,this.lineProperty.color="rgba(0,0,0,0)",
this.fillProperty.opacity=1,this.eventCnt+=1,f};KIP.Objects.ProjectWindow.prototype.RemoveEvents=function(a){a.eventGrp.innerHTML=""};KIP.Objects.ProjectWindow.prototype.AddEvents=function(a,b){var c;if(a.events)for(c=0;c<a.events.length;c+=1)this.AddEvent(a,a.events[c],"","","",b)};
KIP.Objects.ProjectWindow.prototype.ExpandItem=function(a){var b,c,d;d=this;a.expanded?(this.overlayGrp.removeChild(a.grp),this.overlayGrp.removeChild(this.overlay),this.overlayGrp.removeChild(a.eventGrp),this.parent.removeChild(a.addlInfoExpanded),this.itemGrp.appendChild(a.grp),this.eventGrp.appendChild(a.eventGrp),a.expanded=!1,this.expanded=null,this.div.style.cursor="-webkit-grab",a.grp.removeAttribute("transform"),a.eventGrp.removeAttribute("transform"),this.alwaysShowEvents||(this.RemoveEvents(a),
this.AddEvents(a)),a.text.style.fill="#000",a.text.removeAttribute("transform")):(this.fillProperty.opacity=.8,this.fillProperty.color="#000",this.fillProperty.type="solid",this.overlay=this.AddRectangle(this.viewX,this.viewY,this.viewW,this.viewH,"",this.overlayGrp),this.overlay.addEventListener("click",function(){d.ExpandItem(a)}),this.itemGrp.removeChild(a.grp),this.eventGrp.removeChild(a.eventGrp),this.overlayGrp.appendChild(a.grp),this.overlayGrp.appendChild(a.eventGrp),this.parent.appendChild(a.addlInfoExpanded),
a.expanded=!0,this.expanded=a,this.div.style.cursor="default",b=document.documentElement.clientWidth||window.innerWidth,c=document.documentElement.clientHeight||window.innerHeight,b=this.CalculateSVGCoordinates(b-20,2*c/3),c=this.CalculateSVGCoordinates(20,window.innerHeight/3),b.x-=c.x,b.y-=c.y,this.ResizeAndRepositionItem(a,{w:b.x,h:b.y,x:c.x,y:c.y}),a.text.style.fill="rgba(0,0,0,0)",a.text.setAttribute("transform","translate(0,"+-.25*this.MeasureElem(a.text).height+")"),this.alwaysShowEvents||
(this.RemoveEvents(a),this.AddEvents(a,!0)))};KIP.Objects.ProjectWindow.prototype.GetRow=function(a,b){return this.rows.length};
KIP.Objects.ProjectWindow.prototype.AddSVGTextBubble=function(a,b,c,d,e){var f;f=this.CreateGroup(c+"bubble",d);""===c&&(c="??");this.lineProperty.type="none";this.lineProperty.width=0;this.lineProperty.color="rgba(0,0,0,0)";this.fillProperty.type="solid";this.fillProperty.color=this.bubbleColor;d=this.AddRectangle(a,b,0,0,{rx:this.rowHeight/3,ry:this.rowHeight/3},f);e||(e={x:0,y:0});this.fillProperty.color=this.textColor;this.fontProperty.family="Segoe UI Semilight, Calibri, Arial";this.fontProperty.size=
this.rowHeight/3+"pt";b=this.AddText("",c,a,b,"",e,f);c=this.MeasureElem(b);d.setAttribute("width",1.75*c.width);d.setAttribute("height",1.65*c.height);d.setAttribute("x",a);b.setAttribute("x",a+.37*c.width);d.setAttribute("y",c.y-82.5*c.height);return f};
KIP.Objects.ProjectWindow.prototype.AddTextBubble=function(a,b,c,d,e,f){var g,h;if(b)return this.textDiv.parentNode||this.parent.appendChild(this.textDiv),g=KIP.Functions.CreateSimpleElement("txt."+a,"textBubble",a),g.style.position="absolute",g.style.backgroundColor=this.bubbleColor,g.style.color=this.textColor,g.style.fontFamily="Segoe UI Light",g.style.padding="5px",g.style.borderRadius="5px",g.style.fontSize="12px",g.style.boxShadow="1px 1px 8px 2px rgba(0,0,0,.1)",this.textDiv.appendChild(g),
h=this,b.addEventListener("mouseover",function(a){var c,d;KIP.Functions.HasCSSClass(g,"hidden")&&(h.lastBubble&&KIP.Functions.AddCSSClass(h.lastBubble,"hidden"),d=b.getBoundingClientRect(),a=a.x,c=Math.round(d.top+d.height),KIP.Functions.RemoveCSSClass(g,"hidden"),d=g.getBoundingClientRect(),0>a?a=0:a+d.width>window.innerWidth&&(a=window.innerWidth-d.width),0>c?c=0:c+d.height>window.innerHeight&&(c=window.innerHeight-d.height),g.style.left=a+"px",g.style.top=c+"px",h.lastBubble=g,b.style.opacity=
1)}),b.addEventListener("mouseout",function(a){KIP.Functions.AddCSSClass(g,"hidden");b.style.opacity=f}),b.addEventListener("mousemove",function(a){KIP.Functions.HasCSSClass(g,"hidden")||(g.style.left=a.x+"px")}),KIP.Functions.AddCSSClass(g,"hidden"),g};
KIP.Objects.ProjectWindow.prototype.CreateGuidelines=function(){var a,b,c,d,e,f,g,h,k,l;a=this.CalculateScreenCoordinates(this.viewX,this.viewY);0===this.CalculateScreenCoordinates(this.viewX+this.unitWidth/15,this.viewY).x-a.x&&(g=!0);this.viewW>200*this.unitWidth&&(g=!0);for(b=this.lines.length-1;0<=b;--b)this.lines[b]&&this.lines[b].parentNode&&this.lineGrp.removeChild(this.lines[b]);this.lines=[];a=this.viewW/this.unitWidth;e=new Date;e.getDay();this.ConvertToProjectPoint(e);this.fillProperty.type=
"solid";this.lineProperty.type="none";this.lineProperty.color="rgba(0,0,0,0)";for(b=this.lineProperty.width=0;b<a;b+=1){c=this.viewX+(this.unitWidth-this.viewX%this.unitWidth)+b*this.unitWidth;f=this.RevertFromProjectPoint(c/this.unitWidth);h=KIP.Functions.ShortDate(f);d=f.getDay();k="";if(this.importantDates[h])d=this.unitWidth,this.fillProperty.color=this.importantDates[h].color,k=this.importantDates[h].lbl,l=this.importantDates[h].textColor;else if(0===KIP.Functions.DateDiff(f,e))this.fillProperty.color=
"#8AE",d=this.unitWidth;else if(!this.showWeekends||0!==d&&6!==d){if(this.showWeekends||1!==d){if(g)continue;this.fillProperty.color="rgba(220,220,220,.4)"}else{if(g)continue;this.fillProperty.color="rgba(100,100,100,.3)"}d=this.unitWidth/20}else this.fillProperty.color="rgba(0,0,0,.15)",d=this.unitWidth;c=this.AddRectangle(c,this.viewY,d,this.viewH,"",this.lineGrp);this.lines.push(c);k&&(this.fillProperty.color=l,this.fontProperty.size=2*this.unitWidth/3,k=this.AddText(c,k,.5*this.unitWidth,3*this.rowHeight,
"",{x:.5,y:.5},this.lineGrp),c=this.MeasureElem(k),k.setAttribute("y",+k.getAttribute("y")+c.width/2+this.rowHeight),this.RotateElement(k,-90),this.lines.push(k))}this.CreateGuideHeaders(g)};
KIP.Objects.ProjectWindow.prototype.CreateGuideHeaders=function(a){var b,c,d,e,f,g,h;for(c=this.headers.length-1;0<=c;--c)this.headers[c]&&this.headers[c].parentNode&&this.headerGrp.removeChild(this.headers[c]);this.headers=[];f={};h=this.CalculateSVGHeight(this.maxHeaderHeight);this.fillProperty.type="solid";this.fontProperty.size=h/3;this.fontProperty.family="Segoe UI Light,Calibri";this.fillProperty.opacity=1;b=this.viewW/this.unitWidth;for(c=0;c<b;c+=1)e=this.viewX+(this.unitWidth-this.viewX%
this.unitWidth)+(c-1)*this.unitWidth,d=this.RevertFromProjectPoint(e/this.unitWidth),g=d.getMonth()+"."+d.getYear(),f[g]?f[g].end=e:f[g]={name:KIP.Functions.GetMonthName(d),start:e,month:d.getMonth(),year:d.getFullYear()},a||(this.fillProperty.color="#FFF",this.headers.push(this.AddRectangle(e,this.viewY+h,this.unitWidth,h/2,"",this.headerGrp)),this.fillProperty.color="#68C",this.headers.push(this.AddText("",d.getDate(),e+this.unitWidth/4,this.viewY+h,"",{x:0,y:0},this.headerGrp)));for(g in f)f.hasOwnProperty(g)&&
(a=f[g],b=a.end-a.start+this.unitWidth,0>b||isNaN(b)||(this.fillProperty.color=this.monthColors[a.month],this.headers.push(this.AddRectangle(a.start,this.viewY,b,h,"",this.headerGrp)),this.fillProperty.color="#FFF",this.fontProperty.size=h/2,this.headers.push(this.AddText("",a.name.toUpperCase()+" "+a.year,a.start+2*this.unitWidth,this.viewY,"",{x:0,y:0},this.headerGrp))))};
KIP.Objects.ProjectWindow.prototype.Zoom=function(a){this.expanded||(this.lastBubble&&KIP.Functions.AddCSSClass(this.lastBubble,"hidden"),KIP.Objects.SVGDrawable.prototype.Zoom.call(this,a),this.CreateGuidelines(),this.RefreshUI())};KIP.Objects.ProjectWindow.prototype.Pan=function(a,b){this.expanded||(this.lastBubble&&KIP.Functions.AddCSSClass(this.lastBubble,"hidden"),KIP.Objects.SVGDrawable.prototype.Pan.call(this,a,b),this.CreateGuidelines(),this.RefreshUI(!0))};
KIP.Objects.ProjectWindow.prototype.Sort=function(a,b){var c,d,e=this;this.itemHeaders.map(function(a){a&&a.div&&a.div.parentNode&&a.div.parentNode.removeChild(a.div)});this.itemHeaders=[];this.items.sort(a);this.items.map(function(a,g,h){c=b(a);d!==c&&(e.AddItemHeader(g,c),d=c)});this.RefreshUI()};KIP.Objects.ProjectWindow.prototype.Clear=function(){this.ClearUI();this.rows=[];this.items=[];this.eventCnt=0};
KIP.Objects.ProjectWindow.prototype.ClearUI=function(){this.itemGrp.innerHTML="";this.eventGrp.innerHTML="";this.textDiv.innerHTML=""};
KIP.Objects.ProjectWindow.prototype.RemoveItem=function(a,b){var c,d;c=a.id;d=this.items[c];if(d!==a)for(c=0;c<this.items.length&&(d=this.items[c],d!==a);c+=1);this.rows.splice(a.row,1);this.items.splice(c,1);a.grp.innerHTML="";a.grp.parentNode&&a.grp.parentNode.removeChild(a.grp);a.eventGrp.innerHTML="";a.eventGrp.parentNode&&a.eventGrp.parentNode.removeChild(a.eventGrp);a.events&&(this.eventCnt-=a.events.length);if(a.addl.onremove)a.addl.onremove();b||this.RefreshUI()};
KIP.Objects.ProjectWindow.prototype.ResizeAndRepositionItem=function(a,b){var c,d,e,f,g;a.grp.removeAttribute("transform");c=this.MeasureElem(a.grp);0!==c.width&&0!==c.height&&(f=b.scaleW||b.w/c.width,g=b.scaleH||b.h/c.height,d=b.x-c.x,e=b.y-c.y,d+=-1*(f-1)*c.x,e+=-1*(g-1)*c.y,c="matrix("+(f+", ")+"0, 0, "+(g+", "),c+=d+", ",c+=e,c+=")",a.grp.setAttribute("transform",c),a.eventGrp.setAttribute("transform",c))};
KIP.Objects.ProjectWindow.prototype.DisableTitles=function(a){a?(this.rowSpace=2.5,this.showTitles=!0):(this.rowSpace=1.5,this.showTitles=!1);this.RefreshUI()};
KIP.Objects.ProjectWindow.prototype.AdjustY=function(a,b,c){var d,e,f,g,h,k;k=this;this.rows[c]=[this.items[c]];this.items[c].row=c;this.items[c].y=b;d=a.grp;for(e=0;e<d.children.length;e+=1)f=d.children[e],h=f.getAttribute("y"),g||0===g||(g=h),h=h!==g&&f!==a.text?+h-+g:f===a.text?-1:0,f.setAttribute("y",b+h);a.events&&(a.events.map(function(a){var d;a.row=c;a.y=b;for(d=k.eventRow-1;0<=d;--d)a.y+=2*k.barGap*k.rowHeight+k.rowHeight*k.barPercentages[d]}),this.RemoveEvents(a),this.AddEvents(a))};
KIP.Objects.ProjectWindow.prototype.RefreshUI=function(a){var b,c,d,e,f;this.rows=[];for(b=d=0;b<this.items.length;b+=1)c=void 0,this.showTitles?(this.items[b].text&&!this.items[b].text.parentNode&&this.items[b].grp.appendChild(this.items[b].text),c=this.MeasureElem(this.items[b].text),e=this.CalculateScreenCoordinates(this.items[b].x,0).x,f=this.CalculateScreenWidth(this.MeasureElem(this.items[b].grp).width)+e,0>e?(e=this.CalculateSVGCoordinates(0,0).x,0<f?this.items[b].text.setAttribute("x",e):
this.items[b].text.setAttribute("x",f)):this.items[b].text.setAttribute("x",this.items[b].x)):this.items[b].text&&this.items[b].text.parentNode&&this.items[b].text.parentNode.removeChild(this.items[b].text),this.itemHeaders[b]&&(this.headerDiv.appendChild(this.itemHeaders[b].div),c=this.CalculateScreenCoordinates(0,d+this.rowSpace+b*this.rowHeight*this.rowSpace-(c?c.height:0)).y,c+=this.div.getBoundingClientRect().top,this.itemHeaders[b].div.style.top=c+"px",c=this.itemHeaders[b].div.getBoundingClientRect(),
0<c.height&&(d+=this.CalculateSVGHeight(c.height)+1.5*this.rowSpace+(this.headerGap||0))),c=d+b*this.rowHeight*this.rowSpace,a||this.AdjustY(this.items[b],c,b);this.Draw()};KIP.Objects.ProjectWindow.prototype.AddItemHeader=function(a,b){var c;this.headerDiv.parentNode||this.parent.appendChild(this.headerDiv);c=KIP.Functions.CreateSimpleElement("header"+a,"header",b);this.itemHeaders[a]={div:c,lbl:b,key:a}};
KIP.Objects.ProjectWindow.prototype.AddImportantDate=function(a,b,c,d,e,f){var g,h,k,l,m=this;l=function(a,b,c,d,e){m.importantDates[KIP.Functions.ShortDate(a)]={date:new Date(a),lbl:b,color:c||"#C30",textColor:d||"#FFF",category:f}};a.getFullYear||(a=new Date(a));g=0;h=1;e&&!e.getFullYear&&(e=new Date(e));e&&(g=KIP.Functions.DateDiff(e,a),h=0>g?-1:1,g=Math.abs(g));if(a&&a.getFullYear){k=new Date(a);for(e=0;e<=g;e+=h)a=k,l(a,b,c,d,f),a=KIP.Functions.AddToDate(k,{days:1});this.CreateGuidelines();this.Draw()}};
KIP.Objects.ProjectWindow.prototype.CreateImportantDateForm=function(a,b){var c,d,e,f,g,h,k,l,m,n,p,t,q,u=this;a||(a="");c=KIP.Functions.CreateElement({type:"input",id:"dateLabel",cls:"dateLabel",attr:[{key:"placeholder",val:"Label for important date"}]});e=KIP.Functions.CreateElement({type:"input",id:"dateBG",cls:"dateBG",attr:[{key:"type",val:"color"},{key:"value",val:"rgb(0,0,0)"}]});d=KIP.Functions.CreateSimpleElement("bgColorLbl","bgColorLbl","","",[{type:"span",cls:"lbl",before_content:"Background Color: "},
e]);g=KIP.Functions.CreateElement({type:"input",id:"dateTxtColor",cls:"dateTxtColor",attr:[{key:"type",val:"color"},{key:"value",val:"#FFFFFF"}]});f=KIP.Functions.CreateSimpleElement("txtColorLbl","textColorLbl","","",[{type:"span",cls:"lbl",before_content:"Text Color: "},g]);k=KIP.Functions.CreateElement({type:"input",id:"dateDt",cls:"dateDt",attr:[{key:"type",val:"date"},{key:"value",val:"date"}]});h=KIP.Functions.CreateSimpleElement("dtLbl","dtLbl","","",[{type:"span",cls:"lbl",before_content:"Start Date * : "},
k]);m=KIP.Functions.CreateElement({type:"input",id:"dateDt",cls:"dateDt",attr:[{key:"type",val:"date"},{key:"value",val:"date"}]});l=KIP.Functions.CreateSimpleElement("dtLbl","dtLbl","","",[{type:"span",cls:"lbl",before_content:"End Date: "},m]);q=KIP.Functions.CreateElement({type:"select"});for(n=0;n<this.impDateCategories.length;n+=1)p=KIP.Functions.CreateElement({type:"Option",value:n,before_content:this.impDateCategories[n]}),q.appendChild(p);this.impDateCatSelector=q;t=function(){k.value="";
m.value="";c.value="";q.value=0;e.value="#000000";g.value="#FFFFFF"};n=KIP.Functions.CreateSimpleElement("impDateAccept","impDateAccept","Accept");n.addEventListener("click",function(){var a,d;a=k.value;(d=m.value)||(d=a);a&&(a=a.split("-"),d=d.split("-"),u.AddImportantDate(new Date(a[0],a[1]-1,a[2]),c.value,e.value,g.value,new Date(d[0],d[1]-1,d[2]),q.value));t();u.ShowImportantDateForm("",b)});p=KIP.Functions.CreateSimpleElement("impDateCancel","impDateCancel","Cancel");p.addEventListener("click",
function(){t();u.ShowImportantDateForm("",b)});return this.dateForm=KIP.Functions.CreateSimpleElement("impDateForm","impDateForm","","",[h,l,c,d,f,q,n,p])};KIP.Objects.ProjectWindow.prototype.ShowImportantDateForm=function(a,b){this.dateForm||(this.AddImportantDateCategory("Just Me"),this.CreateImportantDateForm("",b));this.dateFormShowing?(this.dateForm.parentNode.removeChild(this.dateForm),this.dateFormShowing=!1):(a.appendChild(this.dateForm),this.dateFormShowing=!0);b&&b()};
KIP.Objects.ProjectWindow.prototype.AddImportantDateCategory=function(a){var b;for(b=0;b<this.impDateCategories.length;b+=1)if(this.impDateCategories[b]===a)return!1;b=this.impDateCategories.length;this.impDateCategories.push(a);if(!this.dateForm)return b;a=KIP.Functions.CreateElement({type:"Option",value:b,before_content:a});this.impDateCatSelector.appendChild(a);return b};KIP.Objects.ProjectWindow.prototype.RemoveImportantDate=function(a){delete this.importantDates[a];this.CreateGuidelines();this.Draw()};KIP.Objects.Select=function(a){KIP.Objects.Drawable.call(this,a,"select");this.id=a;this.input=KIP.Functions.CreateElement({type:"input",cls:"select",id:"input"+a});this.data=[];this.dataDiv=KIP.Functions.CreateSimpleElement("data"+a,"dropdown");this.selectedData=-1;this.options=[];this.visible=[];this.keys={};this.visibleCnt=0;this.div.appendChild(this.input);this.div.appendChild(this.dataDiv);this.AddListeners()};KIP.Objects.Select.prototype=Object.create(KIP.Objects.Drawable.prototype);
KIP.Objects.Select.prototype.AddListeners=function(){var a;a=this;this.input.addEventListener("focus",function(){a.Dropdown()});this.input.addEventListener("blur",function(){a.Dropdown(!0)});this.input.addEventListener("keydown",function(b){a.expanded&&(40===b.keyCode?(a.HiliteNext(),b.preventDefault()):38===b.keyCode?(a.HilitePrevious(),b.preventDefault()):13===b.keyCode&&a.Validate())});this.input.addEventListener("keyup",function(b){a.Filter();b.stopPropagation();return!1})};
KIP.Objects.Select.prototype.Dropdown=function(a){a?(KIP.Functions.RemoveCSSClass(this.dataDiv,"expanded"),this.expanded=!1):(KIP.Functions.AddCSSClass(this.dataDiv,"expanded"),this.expanded=!0,this.hiliteNext=this.selectedData=0)};
KIP.Objects.Select.prototype.AddData=function(a){var b,c,d,e,f;e=this;d=function(a,b){a.addEventListener("mousedown",function(a){e.Select(e.data[b])})};for(b in a)a.hasOwnProperty(b)&&!this.keys[b]&&(f=this.data.push({key:b,val:a[b]}),this.keys[b]=!0,c=KIP.Functions.CreateSimpleElement("opt"+this.id+"|"+f,"opt",a[b]),this.options.push(c),this.visible.push(!0),this.visibleCnt+=1,d(c,f-1),this.dataDiv.appendChild(c));this.Filter()};
KIP.Objects.Select.prototype.Filter=function(){var a,b,c;b=this.input.value.toUpperCase();for(a=0;a<this.data.length;a+=1)c=this.data[a].key.indexOf(b),-1===c&&(c=this.data[a].val.indexOf(b)),-1===c&&this.visible[a]&&(KIP.Functions.AddCSSClass(this.options[a],"filtered"),a===this.selectedData&&(KIP.Functions.RemoveCSSClass(this.options[this.selectedData],"selected"),this.selectedData=-1),this.visible[a]=!1,--this.visibleCnt),-1===c||this.visible[a]||(KIP.Functions.RemoveCSSClass(this.options[a],"filtered"),
this.visible[a]=!0,this.visibleCnt+=1)};KIP.Objects.Select.prototype._Hilite=function(a){var b,c,d;if(0!==this.dataDiv.children.length){0<=this.selectedData&&KIP.Functions.RemoveCSSClass(this.options[this.selectedData],"selected");c=0;for(b=this.selectedData;!d;)if(b+=a,0>b&&(b=this.data.length-1),b>=this.data.length&&(b=0),this.visible[b]&&(d=!0),c+=1,c>this.data.length)return;KIP.Functions.AddCSSClass(this.options[b],"selected");this.selectedData=b}};KIP.Objects.Select.prototype.HiliteNext=function(){return this._Hilite(1)};
KIP.Objects.Select.prototype.HilitePrevious=function(){return this._Hilite(-1)};KIP.Objects.Select.prototype.Select=function(a){var b=this;this.value=a.key;this.input.value=a.val;0<=this.selectedData&&(KIP.Functions.RemoveCSSClass(this.options[this.selectedData],"selected"),this.selectedData=-1);window.setTimeout(function(){b.Dropdown(!0)},100)};
KIP.Objects.Select.prototype.Validate=function(){var a;-1!==this.selectedData&&this.Select(this.data[this.selectedData]);if(1===this.visibleCnt)for(a=0;a<this.visible.length;a+=1)this.visible[a]&&this.Select(this.data[a])};KIP.Objects.Shield=function(a,b){this.id=a;this.entertainmentType=b||"plain";this.addEntertainment=!0;this.options={animateSpeed:300};KIP.Objects.Drawable.call(this,"shield"+a,"shield");this.div.addEventListener("click",function(a){a.stopPropagation();return!1});this.container=KIP.Functions.CreateSimpleElement("shield"+this.id+"|container","container");this.div.appendChild(this.container)};KIP.Objects.Shield.prototype=Object.create(KIP.Objects.Drawable.prototype);
KIP.Objects.Shield.prototype.Show=function(){var a;this.noStyles||this.addedStyles||(this.AddStyles(),this.addedStyles=!0);this.addEntertainment?this.AddEntertainment(this.entertainmentType):this.animateFunc&&(a=this.animateFunc,this.animate=window.setInterval(a,this.options.animateSpeed));this.Draw(document.body)};KIP.Objects.Shield.prototype.Hide=function(){this.Erase();this.animate&&window.clearInterval(this.animate)};
KIP.Objects.Shield.prototype.AddEntertainment=function(){var a,b,c;b=0;switch(this.type){case "trvia":break;case "game":break;default:a=KIP.Functions.CreateSimpleElement("","plain","Loading"),this.animateFunc=c=function(){var c;b+=1;c="";switch(b%6){case 0:c="";break;case 1:c=".";break;case 2:c="..";break;case 3:case 4:case 5:c="..."}a.innerHTML="Loading"+c},this.animate=window.setInterval(c,this.options.animateSpeed)}this.container.appendChild(a);this.addEntertainment=!1};
KIP.Objects.Shield.prototype.AddStyles=function(){var a;KIP.Globals.AddedShieldStyles||(a={"background-color":"rgba(0,0,0,0.7)",position:"fixed",left:"0",top:"0",width:"100%",height:"100%"},KIP.Functions.CreateCSSClass(".shield",a),a={display:"flex","align-items":"center","justify-content":"center",height:"100%"},KIP.Functions.CreateCSSClass(".shield .container",a),a={"font-family":'"Segoe UI", "Calibri", "Arial"',"font-size":"25px",color:"#FFF","text-align":"left",width:"170px"},KIP.Functions.CreateCSSClass(".shield .plain",
a))};window.KIP||(window.KIP={Objects:{Drawable:function(){},Editable:function(){},SVGDrawable:function(){},Form:function(){}},Functions:{},Constants:{},Globals:{},Options:{},Test:{},Events:{}});KIP.Constants.Files="core stringHelper dateTools trig drawable svg_helper color collection server editable hoverable svg ctxmenu form graph projectPlan select".split(" ");KIP.Constants.StandaloneFiles={core:"1",stringHelper:"1",dateTools:"1",trig:"1",drawable:"1",svg_helper:"1",color:"1",collection:"1",server:"1"};
KIP.Constants.DrawableDependents={editable:"1",hoverable:"1",svg:"1",ctxmenu:"1",form:"1",graph:"1",select:"1",projectPlan:"1"};KIP.Constants.DropboxPath="https://dl.dropboxusercontent.com/u/52957066/javascript%20tools/toolkip.js/";KIP.Functions.Include=function(a,b){var c,d,e,f,g;e=0;g=a.length;c=function(a,c){f=function(){e+=1;e===g&&b&&b()};KIP.Functions.CreateScriptElement(a,f);d(c+1)};d=function(b){var d;(d=a[b])&&c(d,b)};d(0)};
KIP.Functions.IncludeKIP=function(a,b,c){var d,e,f,g;f=[];g=[];a||(a=KIP.Constants.Files.slice());b||(b=[]);for(d=a.length-1;0<=d;--d)e=a[d],b[e]||(KIP.Constants.DrawableDependents[e]?g.push(KIP.Constants.DropboxPath+e+".js"):f.push(KIP.Constants.DropboxPath+e+".js"));KIP.Functions.Include(f,function(){KIP.Functions.Include(g,c)})};KIP.Functions.CreateScriptElement=function(a,b){var c;c=document.createElement("script");c.setAttribute("src",a);b&&(c.onload=b);document.head.appendChild(c);return c};
