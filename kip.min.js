var KIP={Objects:{},Functions:{},Constants:{},Globals:{},Options:{},Test:{}};KIP.Functions.CreateSimpleElement=function(a,b,c,d){var e,f;e=document.createElement("div");a&&e.setAttribute("id",a);b&&e.setAttribute("class",b);c&&(e.innerHTML=c);for(f in d)if(d.hasOwnProperty(f))try{e.setAttribute(d[f].key,d[f].val)}catch(g){}return e;};
KIP.Functions.CreateElement=function(a){var b,c,d,e;b=document.createElement(a.type||"div");a.id&&b.setAttribute("id",a.id);a.cls&&b.setAttribute("class",a.cls);a.before_content&&(b.innerHTML=a.before_content);for(c in a.attr)if(a.attr.hasOwnProperty(c))try{b.setAttribute(a.attr[c].key,a.attr[c].val)}catch(f){}for(d in a.children)if(a.children.hasOwnProperty(d))try{a.children[d].setAttribute?b.appendChild(a.children[d]):(e=KIP.Functions.CreateElement(a.children[d]),b.appendChild(e))}catch(f){}a.after_content&&
(b.innerHTML+=a.after_content);return b};KIP.Functions.AddCSSClass=function(a,b){var c;a&&(a.Draw&&(a=a.div),c=" "+a.getAttribute("class")+" ",-1===c.indexOf(" "+b+" ")&&a.setAttribute("class",KIP.Functions.Trim(c+b)))};KIP.Functions.RemoveCSSClass=function(a,b){var c,d;a&&(a.Draw&&(a=a.div),c=" "+a.getAttribute("class")+" ",d=c.length,c=c.replace(" "+b+" "," "),c.length!==d&&a.setAttribute("class",KIP.Functions.Trim(c)))};
KIP.Functions.HasCSSClass=function(a,b){if(a)return a.Draw&&(a=a.div),-1===(" "+a.getAttribute("class")+" ").indexOf(" "+b+" ")?!1:!0};KIP.Functions.SetCSSAttribute=function(a,b,c,d){var e,f,g;for(f=0;f<document.styleSheets.length;f+=1)if(e=document.all?"rules":"cssRules",g=document.styleSheets[f][e])for(e=0;e<g.length;e+=1)if(g[e].selectorText===a&&(g[e].style[b]||d))return g[e].style[b]=c,!0;return!1};
KIP.Functions.GetCSSAttribute=function(a,b){var c,d,e;for(d=0;d<document.styleSheets.length;d+=1)if(c=document.all?"rules":"cssRules",e=document.styleSheets[d][c])for(c=0;c<e.length;c+=1)if(e[c].selectorText===a)return e[c].style[b];return""};KIP.Functions.GetComputedStyle=function(a,b){var c;if(window.getComputedStyle)return c=window.getComputedStyle(a),b?c.getPropertyValue(b):c;if(a.currentStyle)return c=a.currentStyle,b?c[b]:c};
KIP.Functions.GlobalOffsetLeft=function(a,b){return KIP.Functions.auxGlobalOffset(a,"offsetLeft",b)};KIP.Functions.GlobalOffsetTop=function(a,b){return KIP.Functions.auxGlobalOffset(a,"offsetTop",b)};KIP.Functions.GlobalOffsets=function(a,b){return{left:KIP.Functions.GlobalOffsetLeft(a,b),top:KIP.Functions.GlobalOffsetTop(a,b)}};KIP.Functions.auxGlobalOffset=function(a,b,c){for(var d=0;a&&a!==c;)a[b]&&(d+=a[b]),a=a.offsetParent;return d};
KIP.Functions.FindCommonParent=function(a,b){var c,d;if(a&&b)for(c=a,d=b;c;){for(;d;){if(c===d)return c;d=d.parentNode}c=c.parentNode;d=b}};KIP.Functions.MoveRelToElem=function(a,b,c,d,e){var f;b=KIP.Functions.GlobalOffsets(a);f=KIP.Functions.GlobalOffsets(a);c=f.left+c-b.left;d=f.top+d-b.top;e||(a.style.position="absolute",a.style.left=c+"px",a.style.top=d+"px");return{x:c,y:d}};
KIP.Functions.RemoveSubclassFromAllElements=function(a,b,c){var d,e;a=document.getElementsByClassName(a);for(d=0;d<a.length;d+=1)e=a[d],e!==c&&KIP.Functions.RemoveCSSClass(e,b)};
KIP.Functions.AddResizingElement=function(a,b,c,d){var e,f;KIP.Globals.Resizables||(KIP.Globals.Resizables=[]);e=KIP.Globals.Resizables.length;KIP.Globals.Resizables[e]={o_x:KIP.Functions.GlobalOffsetLeft(a),o_y:KIP.Functions.GlobalOffsetTop(a),o_w:a.offsetWidth,o_h:a.offsetHeight,g_w:c||window.innerWidth,g_h:d||window.innerWidth*b||window.innerHeight,h_w_ratio:b||1,elem:a};f=KIP.Globals.Resizables[e];window.addEventListener("resize",function(){KIP.Functions.ResizeElement(f)});return e};
KIP.Functions.ResizeElement=function(a){var b,c,d,e;d=window.innerWidth/a.g_w;c=a.h_w_ratio*window.innerWidth||window.innerHeight;e=c/a.g_h;b=a.o_x/a.g_w;a.elem.style.left=b*window.innerWidth+"px";b=a.o_y/a.g_h;a.elem.style.top=b*c+"px";a.elem.style.width=a.o_w*d+"px";a.elem.style.height=a.o_h*e+"px"};KIP.Functions.RemoveElemFromArr=function(a,b,c){var d;c||(c=function(a,b){return a===b});for(d=a.length-1;0<=d;--d)c(a[d],b)&&a.splice(d,1)};
KIP.Functions.RoundToPlace=function(a,b){return Math.round(a*b)/b};KIP.Functions.DateDiff=function(a,b,c,d){a=a>b||c?a-b:b-a;return d?a:Math.round(a/864E5)};KIP.Functions.ShortDate=function(a){var b;b=parseInt(a.getFullYear())%100;return a.getMonth()+1+"/"+a.getDate()+"/"+b};KIP.Functions.ShortTime=function(a,b){var c,d,e;c=parseInt(a.getMinutes());d=parseInt(a.getHours());e="";10>c&&(c="0"+c);b&&(e=" AM",12<=d&&(e=" PM"),12<d&&(d-=12));return d+":"+c+e};KIP.Functions.ShortDateTime=function(a,b){return KIP.Functions.ShortDate(a)+" "+KIP.Functions.ShortTime(a,b)};
KIP.Functions.StopwatchDisplay=function(a,b,c){var d,e,f;c=Math.floor(a/1E3);a%=1E3;d=Math.floor(c/60);c%=60;e=Math.floor(d/60);d%=60;f=Math.floor(e/24);e%=24;b||(b=KIP.Functions.AddLeadingZeroes(2,String(c),String(d),String(e)),c=b[0],d=b[1],e=b[2]);return f+"D  "+e+":"+d+":"+c+" '"+a};KIP.Functions.AddLeadingZeroes=function(a){var b,c,d,e;e=[];for(b=1;b<arguments.length;b+=1)for(c=arguments[b],d=c.length;d<a;d+=1)e[b-1]="0"+c;return e};
KIP.Functions.AddToDate=function(a,b){b.milliseconds&&a.setMilliseconds(a.getMilliseconds()+b.milliseconds);b.seconds&&a.setSeconds(a.getSeconds()+b.seconds);b.minutes&&a.setMinutes(a.getMinutes()+b.minutes);b.hours&&a.setHours(a.getHours()+b.hours);b.days&&a.setDate(a.getDate()+b.days);return a};KIP.Functions.Piece=function(a,b,c){var d,e,f;e=-1;f=a.indexOf(b);for(d=0;d<c-1;d+=1)if(e=f,f=a.indexOf(b,f+1),-1===e)return"";return-1===f?a.substr(e+1):a.substring(e+1,f)};KIP.Functions.TitleCase=function(a,b){var c,d,e;b=b||" ";e="";c=a.split(b);for(d=0;d<c.length;d+=1)0!==d&&(e+=b),e+=KIP.Functions.CharAt(c[d],0).toUpperCase(),e+=KIP.Functions.Rest(c[d],1).toLowerCase();return e};
KIP.Functions.SentenceCase=function(a){var b;b=KIP.Functions.CharAt(a,0).toUpperCase();return b+=KIP.Functions.Rest(a,1).toLowerCase()};KIP.Functions.CharAt=function(a,b){return a.substr(b,1)};KIP.Functions.Rest=function(a,b){return a.substring(b,a.length)};KIP.Functions.Trim=function(a){a=a.replace(/^\s*/g,"");return a=a.replace(/\s*?$/g,"")};KIP.Constants.HueInterval=22;KIP.Constants.LightInterval=20;KIP.Constants.SaturationInterval=20;KIP.Constants.SaturationLimits={Max:100,Min:20};KIP.Constants.LightnessLimits={Max:80,Min:35};KIP.Constants.HSLPieceEnum={Saturation:0,Lightness:1,Hue:2};
KIP.Functions.GenerateColor=function(a,b){var c;KIP.Globals.UsedColors||(KIP.Globals.UsedColors={});KIP.Globals.ColorObj||(KIP.Globals.ColorObj=new KIP.Objects.Color,KIP.Globals.ColorObj.ParseFromHSLColor("hsl(330, 80%, 50%)"));c=KIP.Globals.ColorObj.GetNextHue(b||0);a&&(KIP.Globals.UsedColors[a]=c);return c};KIP.Functions.GetCurrentColor=function(){KIP.Globals.ColorObj||(KIP.Globals.ColorObj=new KIP.Objects.Color,KIP.Globals.ColorObj.ParseFromHSLColor("hsl(330, 80%, 50%)"));return KIP.Globals.ColorObj.GetCurrentHue()};
KIP.Functions.HexToRGB=function(a){var b;b=new KIP.Objects.Color;b.ParseFromHexColor(a);return b.RGBString()};KIP.Functions.HexToRBA=function(a,b){var c;c=new KIP.Objects.Color;c.ParseFromHexColor(a,b);return c.RGBAString()};KIP.Functions.HSLToRGB=function(a){var b;b=new KIP.Objects.Color;b.ParseFromHSLColor(a);return b.RGBString()};KIP.Functions.HSLAToRBGA=function(a,b){var c;c=new KIP.Objects.Color;c.ParseFromHSLColor(a,b);return c.RGBAString()};
KIP.Functions.FullHexString=function(a,b){var c,d;b=b||0;c=a.toString(16);if(c.length<b)for(d=0;d<c.length-b;d+=1)c="0"+c;return c};KIP.Objects.Color=function(a,b,c,d){this.red=a||0;this.green=b||0;this.blue=c||0;this.alpha=d||1};KIP.Objects.Color.prototype.RGBAString=function(){return this.RGBString(!0)};KIP.Objects.Color.prototype.RGBString=function(a){var b;b="rgba("+this.red+", "+this.green+", "+this.blue;a&&(b+=", "+this.alpha);return b+")"};
KIP.Objects.Color.prototype.HSLString=function(a){var b;this.hue||this.GenerateHSLValues();b="hsl("+this.hue+", "+this.saturation+"%, "+this.lightness+"%";a&&(b+=", "+this.alpha);return b+")"};KIP.Objects.Color.prototype.HSLAString=function(){return this.HSLString(!0)};
KIP.Objects.Color.prototype.HexString=function(a){var b;b="#"+KIP.Functions.FullHexString(this.red,2);b+=KIP.Functions.FullHexString(this.green,2);b+=KIP.Functions.FullHexString(this.blue,2);a&&(b+=KIP.Functions.FullHexString(this.alpha,2));return b};
KIP.Objects.Color.prototype.GenerateHSLValues=function(){var a,b,c,d,e,f,g;a=this.red/255;b=this.green/255;c=this.blue/255;f=Math.max(a,b,c);g=Math.min(a,b,c);e=f-g;d=(f+g)/2;f===g?(this.saturation=this.hue=0,this.lightness=Math.round(100*d)):(f===a?(a=(b-c)/e,b<c&&(a+=6)):a=f===b?(c-a)/e+2:(a-b)/e+4,this.hue=Math.round(a/6*3600)/10,this.saturation=Math.round(1E3*(.5<d?e/(2-f-g):e/(f+g)))/10,this.lightness=Math.round(1E3*d)/10,this.startHue||(this.startHue=this.hue,this.startSat=this.saturation,this.startLight=
this.lightness))};KIP.Objects.Color.prototype.GenerateRGBValues=function(){var a,b,c,d,e;a=this.hue/360;b=this.saturation/100;c=this.lightness/100;if(0===b)return this.red=this.green=this.blue=c,!0;b=.5>c?c*(1+b):c+b-c*b;c=2*c-b;for(e=-1;1>=e;e+=1)d=a+-e/3,0>d?d+=1:1<d&&--d,d<1/6?this.SetAppropriateColor(e+1,255*(c+6*(b-c)*d)):.5>d?this.SetAppropriateColor(e+1,255*b):d<2/3?this.SetAppropriateColor(e+1,255*(c+(b-c)*(2/3-d)*6)):this.SetAppropriateColor(e+1,255*c)};
KIP.Objects.Color.prototype.ParseFromHexColor=function(a,b){var c,d,e,f;if(!/^#?(?:[0-9A-Fa-f]{3,4}){1,2}$/.test(a))return!1;"#"===KIP.Functions.CharAt(a,0)&&(a=KIP.Functions.Rest(a,1));f=6>a.length?1:2;for(c=0;c<a.length;c+=f)d=a.substr(c,f),1===f&&(d+=d),d=parseInt(d,16),this.SetAppropriateColor(c/f,d),4<c&&(e=!0);e||(this.alpha=b||0);return!0};
KIP.Objects.Color.prototype.ParseFromRGBColor=function(a,b){var c,d;c=/rgb\((?:([0-9]{1-3}), ?){3}\)/;d=/rgba\((?:([0-9]{1-3}), ?){3}, ?([0-9]{0,1}(?:\.[0-9]+)?)\)/;if(c.test(a))c=c.exec(a);else if(d.test(a))c=d.exec(a);else return!1;this.red=c[1];this.green=c[2];this.blue=c[3];if(void 0!==c[4]||void 0!==b)this.alpha=c[4]||b;return!0};
KIP.Objects.Color.prototype.ParseFromHSLColor=function(a,b){var c,d;c=/hsl\(([0-9]{1,3}), ?([0-9]{1,3})%, ?([0-9]{1,3})%\)/;d=/hsla\(([0-9]{1,3}), ?([0-9]{1,3})%, ?([0-9]{1,3})%, ?([0-9]{0,1}(?:\.[0-9]+)?)\)/;if(c.test(a))c=c.exec(a);else if(d.test(a))c=d.exec(a);else return!1;this.hue=Math.round(10*parseFloat(c[1]))/10;this.saturation=Math.round(10*parseFloat(c[2]))/10;this.lightness=Math.round(10*parseFloat(c[3]))/10;if(void 0!==c[4]||void 0!==b)this.alpha=parseFloat(c[4])||b;this.GenerateRGBValues();
return!0};KIP.Objects.Color.prototype.ParseColorString=function(a,b){var c;return(c=this.ParseFromRGBColor(a,b))||(c=this.ParseFromHexColor(a,b))?!0:(c=this.ParseFromHSLColor(a,b))?!0:!1};KIP.Objects.Color.prototype.SetAppropriateColor=function(a,b){b=3>a?Math.min(255,Math.max(0,Math.round(b))):Math.min(1,Math.max(0,b));switch(a){case 0:this.red=b;break;case 1:this.green=b;break;case 2:this.blue=b;break;case 3:this.alpha=b}};
KIP.Objects.Color.prototype.GetNextHue=function(a,b){var c=[],d;this.startHue||this.GenerateHSLValues();c[0]=a;c[1]=(a+1)%3;c[2]=(a+2)%3;for(d=0;d<c.length&&this.RotateAppropriateHSLValue(c[d]);d+=1);this.GenerateRGBValues();return this.HexString(b)};KIP.Objects.Color.prototype.GetCurrentHue=function(a){return this.HexString(a)};
KIP.Objects.Color.prototype.RotateAppropriateHSLValue=function(a){var b,c;switch(a){case KIP.Constants.HSLPieceEnum.Saturation:b=this.RotateSaturation();c=this.startSat;break;case KIP.Constants.HSLPieceEnum.Lightness:b=this.RotateLightness();c=this.startLight;break;case KIP.Constants.HSLPieceEnum.Hue:b=this.RotateHue(),c=this.startHue}return b===c?!0:!1};KIP.Objects.Color.prototype.RotateHue=function(){return this.hue=this.RotateHSLValue(this.hue,KIP.Constants.HueInterval,360)};
KIP.Objects.Color.prototype.RotateSaturation=function(){return this.saturation=this.RotateHSLValue(this.saturation,KIP.Constants.SaturationInterval,100,KIP.Constants.SaturationLimits.Max,KIP.Constants.SaturationLimits.Min)};KIP.Objects.Color.prototype.RotateLightness=function(){return this.lightness=this.RotateHSLValue(this.lightness,KIP.Constants.LightInterval,100,KIP.Constants.LightnessLimits.Max,KIP.Constants.LightnessLimits.Min)};
KIP.Objects.Color.prototype.RotateHSLValue=function(a,b,c,d,e){var f;f=a+=b;f%=c;if(!d||!e&&0!==e)return KIP.Functions.RoundToPlace(f,10);for(;f<e||f>d;)f=a+=b,f%=c;return KIP.Functions.RoundToPlace(f,10)};
KIP.Objects.Color.prototype.GetApparentColor=function(a){var b;if(a.red)b=a;else if(b=new KIP.Objects.Color,!b.ParseColorString(a))return!1;a=1-this.alpha;this.red=Math.round(this.red*this.alpha+b.red*a);this.green=Math.round(this.green*this.alpha+b.green*a);this.blue=Math.round(this.blue*this.alpha+b.blue*a);this.alpha=1;return!0};KIP.Objects.Color.prototype.IsDark=function(){this.hue||this.GenerateHSLValues();return 50>=this.lightness};
KIP.Objects.Color.prototype.IsLight=function(){this.hue||this.GenerateHSLValues();return 50<this.lightness};KIP.Functions.AJAXRequest=function(a,b,c,d,e){var f=!1;try{f=new XMLHttpRequest}catch(g){try{f=new ActiveXObject("Msxml2.XMLHTTP")}catch(h){try{f=new ActiveXObject("Microsoft.XMLHTTP")}catch(m){return!1}}}if(!f)return!1;"function"!==typeof c&&(c=function(){});"function"!==typeof d&&(d=function(){});f.onreadystatechange=function(){if(4===f.readyState)return 200===f.status?c(f.responseText):d(f.responseText)};"GET"===a?(f.open("GET",b,!0),f.send(null)):"POST"===a&&(f.open("POST",b,!0),f.setRequestHeader("Content-type",
"application/x-www-form-urlencoded"),f.send(e));return f};KIP.Functions.CreateSVG=function(a,b,c,d,e,f){if(a||0===a){var g=document.createElementNS("http://www.w3.org/2000/svg","svg");g.setAttribute("id",a);g.setAttribute("width",b||0);g.setAttribute("height",c||0);g.setAttribute("viewBox",d||"0 0 0 0");e&&(g.innerHTML=e);f||g.setAttribute("preserveAspectRatio","xMinYMin meet");return g}};
KIP.Functions.CreateSVGElem=function(a,b,c,d){var e;a=document.createElementNS("http://www.w3.org/2000/svg",b);c&&a.setAttribute("class",c);for(e in d)d.hasOwnProperty(e)&&a.setAttribute(e,d[e]);return a};KIP.Objects.Drawable=function(a,b,c){this.div=KIP.Functions.CreateSimpleElement(a,b,c);this.children=[];this.style=this.div.style};KIP.Objects.Drawable.prototype.AppendChild=function(a,b,c){this.children||(this.children=[]);c||0===c||(c=this.children.length);a.Draw&&(this.children.splice(c,0,a),this.children[c].parent=b||this.div)};
KIP.Objects.Drawable.prototype.RemoveChild=function(a){var b;if(!this.children)return!1;for(b=0;b<this.children.length;b+=1)this.children[b]===a&&this.children.splice(b,1);a.parentNode&&a.parentNode.removeChild(a);return!0};
KIP.Objects.Drawable.prototype.Draw=function(a,b){this.div&&(this.parent=a||this.parent,this.Refresh(),this.div.parentNode&&!b&&this.div.parentNode.removeChild(this.div),this.parent.appendChild(this.div),this.BeforeDrawChildren(),this.children&&(this.children.map(function(a,b,e){a&&a.Draw()}),this.AfterDrawChildren()))};KIP.Objects.Drawable.prototype.Erase=function(){this.div.parentNode&&this.div.parentNode.removeChild(this.div)};KIP.Objects.Drawable.prototype.Refresh=function(){};
KIP.Objects.Drawable.prototype.BeforeDrawChildren=function(){};KIP.Objects.Drawable.prototype.AfterDrawChildren=function(){};KIP.Functions.DrawLine=function(a,b,c){var d,e;d=KIP.Functions.GetDistance(a,b);b=KIP.Functions.GetAngle(a,b);e=KIP.Functions.CreateSimpleElement("","angledLine");e.style.position="absolute";e.style.left=a.x+"px";e.style.top=a.y+"px";e.style.width=d+"px";e.style.height="1px";e.style.transformOrigin="0px 0px";e.style.transform="rotate("+b+"deg)";c.appendChild(e);return e};
KIP.Functions.ConnectElements=function(a,b){var c,d,e,f,g;g=KIP.Functions.FindCommonParent(a,b);c=KIP.Functions.GlobalOffsetLeft(a,g)+a.offsetWidth/2;d=KIP.Functions.GlobalOffsetLeft(b,g)+b.offsetWidth/2;e=KIP.Functions.GlobalOffsetTop(a,g)+a.offsetHeight/2;f=KIP.Functions.GlobalOffsetTop(b,g)+b.offsetHeight/2;return KIP.Functions.DrawLine({x:c,y:e},{x:d,y:f},g)};KIP.Functions.GetDistance=function(a,b){var c,d;c=a.x-b.x;d=a.y-b.y;return Math.sqrt(c*c+d*d)};
KIP.Functions.GetAngle=function(a,b){var c,d,e,f;c=b.x-a.x;d=b.y-a.y;if(0===c)return 0>d?270:90;if(0===d)return 0>c?180:0;e=0>c?Math.PI:0;f=Math.atan(Math.abs(d)/Math.abs(c));f=f*(0<c*d?1:-1)+e;return 180/Math.PI*f};KIP.Functions.DegreesToRadians=function(a){return Math.PI*a/180};KIP.Objects.Editable=function(a,b,c,d,e){this.id=a;this.type=b||"text";this.content=c;this.validate=d;this.update=e;this.is_modifying=!1;KIP.Objects.Drawable.call(this,this.id,"editable",this.content);this.CreateElements();this.AddListeners()};KIP.Objects.Editable.prototype=Object.create(KIP.Objects.Drawable.prototype);
KIP.Objects.Editable.prototype.AddListeners=function(){var a=this;this.div.onclick=function(b){a.is_modifying||a.Modify();b.stopPropagation&&b.stopPropagation();null!==b.cancelBubble&&(b.cancelBubble=!0)};window.addEventListener("click",function(b){b.target!==a.div&&a.is_modifying&&a.Save()});this.inputDiv.onkeydown=function(b){13===b.keyCode&&a.is_modifying&&a.Save()}};
KIP.Objects.Editable.prototype.CreateElements=function(){this.inputDiv=KIP.Functions.CreateElement({type:"input",id:this.id+"|input",attr:[{key:"type",val:this.type}]})};KIP.Objects.Editable.prototype.Modify=function(){this.is_modifying=!0;this.inputDiv.value=this.content;this.div.innerHTML="";this.div.appendChild(this.inputDiv);this.inputDiv.select();this.inputDiv.focus()};
KIP.Objects.Editable.prototype.Save=function(){var a;a=this.inputDiv.value;this.div.removeChild(this.inputDiv);this.is_modifying=!1;this.validate&&!this.validate(a)?(this.inputDiv.value=this.content,this.div.innerHTML=this.content):(this.content=a,this.div.innerHTML=a,this.update&&this.update(this.content,this))};KIP.Globals.HoverOffsetEnum={Top:1,TopRightAlign:17,Bottom:2,BottomRightAlign:18,Left:4,LeftBottomAlign:36,Right:8,RightAlign:16,BottomAlign:32,RightBottomAlign:40,"Top-Left":5,"Top-Right":9,"Bottom-Left":6,"Bottom-Right":10,Custom:0};
KIP.Objects.Hoverable=function(a,b,c,d,e,f,g){this.id=a;this.cls="hoverable "+b;this.content=c;this.reference=d;this.offset=e||KIP.Globals.HoverOffsetEnum.Top;this.isSVG=f;this.adjust=g||{x:0,y:0};this.enabled=!1;KIP.Objects.Drawable.call(this,this.id,this.cls,this.content);this.div.style.position="absolute"};KIP.Objects.Hoverable.prototype=Object.create(KIP.Objects.Drawable.prototype);KIP.Objects.Hoverable.prototype.SetEnabled=function(a){this.enabled=a};
KIP.Objects.Hoverable.prototype.Draw=function(a){var b=this;(this.parent=a||this.parent)&&this.enabled&&(this.SetupParent(),this.MoveChild(),KIP.Objects.Drawable.prototype.Draw.call(this,this.parent),this.AdjustChild(),this.nudged=!0,window.setTimeout(function(){b.nudged||(b.NudgeOnscreen(),b.nudged=!0)},0))};
KIP.Objects.Hoverable.prototype.SetupParent=function(){this.parent&&(this.parent.style.position=KIP.Functions.GetComputedStyle(this.parent,"position"),"static"===this.parent.style.position&&(this.parent.style.position="relative"))};
KIP.Objects.Hoverable.prototype.MoveChild=function(){var a,b,c,d;d=c=0;this.offset!==KIP.Globals.HoverOffsetEnum.Custom&&(this.reference||(this.reference=this.parent),this.isSVG?(b=this.reference.getBoundingClientRect(),c=b.left,a=b.right-b.left,b=b.bottom-b.top):(a=this.reference.offsetWidth,b=this.reference.offsetHeight),d=this.offset&KIP.Globals.HoverOffsetEnum.Top?d+-1*b:this.offset&KIP.Globals.HoverOffsetEnum.Bottom?d+b:d+0,c=this.offset&KIP.Globals.HoverOffsetEnum.Left?c+-1*a:this.offset&KIP.Globals.HoverOffsetEnum.Right?
c+a:c+0,this.div.style.left=c+"px",this.div.style.top=d+"px")};
KIP.Objects.Hoverable.prototype.AdjustChild=function(){var a,b,c,d,e,f,g,h;if(this.offset!==KIP.Globals.HoverOffsetEnum.Custom){a=this.div.offsetWidth;b=this.div.offsetHeight;c=this.div.offsetLeft;d=this.div.offsetTop;e=KIP.Functions.GlobalOffsetLeft(this.div);f=KIP.Functions.GlobalOffsetTop(this.div);g=this.parent.offsetWidth;h=this.parent.offsetHeight;this.offset&KIP.Globals.HoverOffsetEnum.Top&&(d=-1*b);this.offset&KIP.Globals.HoverOffsetEnum.RightAlign&&(c=g-a);this.offset&KIP.Globals.HoverOffsetEnum.Left&&
(c=-1*a);this.offset&KIP.Globals.HoverOffsetEnum.BottomAlign&&(d=h-b);0>e+a&&(c=this.reference.offsetWidth);e>window.innerWidth&&(c=-1*a);if(f>window.innerHeight||0>e)d=-1*b,c=0;0>f+b&&(d=this.reference.offsetHeight);KIP.Functions.MoveRelToElem(this.div,this.reference,c+(this.adjust.x||0),d+(this.adjust.y||0))}};
KIP.Objects.Hoverable.prototype.NudgeOnscreen=function(){var a,b,c,d,e,f;this.offset!==KIP.Globals.HoverOffsetEnum.Custom&&(a=this.div.offsetWidth,b=this.div.offsetHeight,c=this.div.offsetLeft,d=this.div.offsetTop,e=KIP.Functions.GlobalOffsetLeft(this.div),f=KIP.Functions.GlobalOffsetTop(this.div),this.offset&KIP.Globals.HoverOffsetEnum.Left||this.offset&KIP.Globals.HoverOffsetEnum.Right||(0>e&&(c+=-1*e),e+a>window.innerWidth&&(c-=e+a-window.innerWidth)),this.offset&KIP.Globals.HoverOffsetEnum.Top||
this.offset&KIP.Globals.HoverOffsetEnum.Bottom||(f+b>window.innerHeight&&(d-=f+b-window.innerHeight),0>f&&(d+=-1*f)),KIP.Functions.MoveRelToElem(this.div,this.reference,c,d))};KIP.Objects.ContextMenu=function(a){KIP.Objects.Drawable.call(this,"ctxMenu","ctxMenu");this.options=[];this.xOptions=[];this.target=a||window;this.div.style.position="absolute";this.AddEventListeners()};KIP.Objects.ContextMenu.prototype=Object.create(KIP.Objects.Drawable.prototype);KIP.Objects.ContextMenu.prototype.AddOption=function(a,b){var c;c=this.options.length;this.xOptions[a]=c;c=KIP.Functions.CreateSimpleElement("opt|"+c,"ctxOption",a);c.onclick=b;this.div.appendChild(c)};
KIP.Objects.ContextMenu.prototype.RemoveOption=function(a){a=this.xOptions[a];this.div.removeChild(this.options[a].div);this.options.splice(a,1)};KIP.Objects.ContextMenu.prototype.ClearOptions=function(){this.options.map(function(a){this.div.removeChild(a.div)});this.options.length=0;this.xOptions.length=0};
KIP.Objects.ContextMenu.prototype.AddEventListeners=function(){var a=this;window.addEventListener("contextmenu",function(){console.log("erasing");a.Erase()},!0);window.addEventListener("click",function(b){a.Erase()});this.target.addEventListener("contextmenu",function(b){var c;a.Erase();if(b.ctrlKey)return!0;b.stopPropagation();b.preventDefault();c=b.clientX;b=b.clientY;a.div.style.left=c+"px";a.div.style.top=b+"px";a.Draw(document.body);c+a.div.offsetWidth>window.innerWidth&&(c=window.innerWidth-
a.div.offsetWidth);b+a.div.offsetHeight>window.innerHeight&&(b=window.innerHeight-a.div.offsetHeight);a.div.style.left=c+"px";a.div.style.top=b+"px";return!1},!1)};KIP.Objects.SVGDrawable=function(a){this.div=KIP.Functions.CreateSVG(a);this.elements=[];this.elementsByID=[];this.min_y=this.min_x=1E6;this.max_y=this.max_x=0;this.gutter=1;this.cur_ID=0};KIP.Objects.SVGDrawable.prototype=Object.create(KIP.Objects.Drawable.prototype);KIP.Objects.SVGDrawable.prototype.CalculateView=function(){return this.min_x+" "+this.min_y+" "+(this.max_x-this.min_x)+" "+(this.max_y-this.min_y)};
KIP.Objects.SVGDrawable.prototype.AddRectangle=function(a,b,c,d,e,f,g,h){this.UpdateView(a,b,c,d);return this.AddChild("rect",{height:d,width:c,x:a,y:b},e,f,g,h)};KIP.Objects.SVGDrawable.prototype.UpdateView=function(a,b,c,d){a<this.min_x&&(this.min_x=a-this.gutter);a+c>this.max_x&&(this.max_x=a+c+this.gutter);b<this.min_y&&(this.min_y=b-this.gutter);b+d>this.max_y&&(this.max_y=b+d+this.gutter);this.view=this.CalculateView();this.div.setAttribute("viewBox",this.view)};
KIP.Objects.SVGDrawable.prototype.AddPath=function(a,b,c){};KIP.Objects.SVGDrawable.prototype.MoveTo=function(a,b,c){var d;d=c.getAttribute("d");c.setAttribute("d",d+("M"+a+" "+b+"\n"));return c};KIP.Objects.SVGDrawable.prototype.LineTo=function(a,b,c){var d;d=c.getAttribute("d");c.setAttribute("d",d+("L "+a+" "+b+"\n"));return c};
KIP.Objects.SVGDrawable.prototype.CurveTo=function(a,b,c,d){var e;e=d.getAttribute("d");e+="C "+a.x+" "+a.y+", ";e+=b.x+" "+b.y+", ";e+=c.x+" "+c.y+"\n";d.setAttribute("d",e);return d};KIP.Objects.SVGDrawable.prototype.ArcTo=function(a,b,c,d,e,f){var g;g=f.getAttribute("d");g+="A "+a.x+" "+a.y;g=g+(" "+b+" "+c+" "+d)+(" "+KIP.Functions.RoundToPlace(e.x,1E3)+" "+KIP.Functions.RoundToPlace(e.y,1E3)+"\n");f.setAttribute("d",g);return f};
KIP.Objects.SVGDrawable.prototype.FinishPath=function(a){var b;b=a.getAttribute("d");a.setAttribute("d",b+" Z");return a};
KIP.Objects.SVGDrawable.prototype.AddRegularPolygon=function(a,b,c,d,e,f,g,h){var m,l,k;this.UpdateView(a-d,b-d,2*d,2*d);m=KIP.Functions.RoundToPlace(KIP.Functions.DegreesToRadians(360/c),1E3);e=this.AddChild("polygon",{points:""},e,f,g,h);f="";for(g=k=0;g<c;g+=1)h=a+KIP.Functions.RoundToPlace(Math.sin(k)*d,10),l=b+KIP.Functions.RoundToPlace(-1*Math.cos(k)*d,10),k+=m,f+=h+","+l+" ";e.setAttribute("points",f)};KIP.Objects.SVGDrawable.prototype.AddRegularStar=function(a,b,c,d,e,f,g){};
KIP.Objects.SVGDrawable.prototype.AddCircle=function(a,b,c,d,e,f,g){this.UpdateView(a-c,b-c,2*c,2*c);return this.AddChild("circle",{cx:a,cy:b,r:c},d,e,f,g)};KIP.Objects.SVGDrawable.prototype.AddPath=function(){};
KIP.Objects.SVGDrawable.prototype.AddPerfectArc=function(a,b,c,d,e,f,g,h,m,l){var k,n,p,r,q;k=parseInt(g.stroke.width,10)||1;this.UpdateView(a.x-b-k,a.y-b-k,2*(b+k),2*(b+k));r=d-c;k=Math.sin(KIP.Functions.DegreesToRadians(c))*b+a.x;n=-1*Math.cos(KIP.Functions.DegreesToRadians(c))*b+a.y;p=Math.sin(KIP.Functions.DegreesToRadians(d))*b+a.x;d=-1*Math.cos(KIP.Functions.DegreesToRadians(d))*b+a.y;q=parseInt(g.stroke.width,10)*Math.sqrt(2)||0;c=KIP.Functions.DegreesToRadians(r+c);g=this.AddChild("path",
{d:""},g,h,m,l);n+=-1*Math.cos(c)*q;k+=Math.sin(c)*q;d+=-1*Math.cos(c)*q;p+=Math.sin(c)*q;a.y+=-1*Math.cos(c)*q;a.x+=Math.sin(c)*q;this.MoveTo(k,n,g);this.ArcTo({x:b,y:b},0,180<r?1:0,e,{x:p,y:d},g);if(f)return g;this.LineTo(a.x,a.y,g);this.FinishPath(g);return g};
KIP.Objects.SVGDrawable.prototype.AddChild=function(a,b,c,d,e,f){if(a)return d||(d=this.cur_ID,this.cur_ID+=1),a=KIP.Functions.CreateSVGElem(d,a,e,b),this.AssignStyle(c,a),this.elements[this.elements.length]=a,this.elementsByID[d]=a,f?f.appendChild(a):this.div.appendChild(a),a};
KIP.Objects.SVGDrawable.prototype.AddText=function(a,b,c,d,e,f,g,h,m){var l,k,n;if(a){l=parseInt(a.getAttribute("cx"));k=parseInt(a.getAttribute("cy"));n=parseInt(a.getAttribute("x"));a=parseInt(a.getAttribute("y"));if(n||0===n)c+=n;else if(l||0===l)c=l-c;if(a||0===a)d+=a;else if(k||0===k)d=k+d}f=KIP.Functions.CreateSVGElem(f,"text",g,{x:c,y:d});f.innerHTML=b;this.AssignStyle(e,f);b=this.MeasureElem(f);h&&(e=h.x*b.width,h=h.y*b.height,c-=e-0,d-=h-b.height,f.setAttribute("x",c),f.setAttribute("y",
d));this.UpdateView(c,d-b.height,b.width,b.height);m?m.appendChild(f):this.div.appendChild(f);return f};KIP.Objects.SVGDrawable.prototype.MeasureElem=function(a){var b,c,d;b=this.parent;d=a.parentNode;document.body.appendChild(this.div);this.div.appendChild(a);c=a.getBBox();this.div.removeChild(a);document.body.removeChild(this.div);this.parent=b;d&&d.appendChild(a);return c};
KIP.Objects.SVGDrawable.prototype.Draw=function(a,b,c,d){b===this.w&&c===this.h&&d===this.view||this.AdjustSize(b,c,d);KIP.Objects.Drawable.prototype.Draw.call(this,a)};KIP.Objects.SVGDrawable.prototype.AssignStyle=function(a,b){a&&(a.fill&&this.AssignFillValues(a.fill,b),a.stroke&&this.AssignStrokeValues(a.stroke,b),a.font&&this.AssignFontValues(a.font,b))};
KIP.Objects.SVGDrawable.prototype.AssignFontValues=function(a,b){if(!a)return b;a.size&&(b.style.fontSize=a.size);a.family&&(b.style.fontFamily=a.family);a.weight&&(b.style.fontWeight=a.weight);a.style&&(b.style.fontStyle=a.style);a.color&&(b.style.fill=a.color);return b};
KIP.Objects.SVGDrawable.prototype.AssignStrokeValues=function(a,b){if(!a||!a.type||"None"===a.type)return b.style.stroke="None",b;a.color&&(b.style.stroke=a.color);a.opacity&&(b.style.strokeOpacity=a.opacity);a.width&&(b.style.strokeWidth=a.width);a.lineCap&&(b.style.strokeLinecap=a.lineCap);a.lineJoin&&(b.style.strokeLinejoin=a.lineJoin);return b};
KIP.Objects.SVGDrawable.prototype.AssignFillValues=function(a,b){if(!a||!a.type||"None"===a.type)return b.style.fill="None",b;a.color&&(b.style.fill=a.color);a.opacity&&(b.style.fillOpacity=a.opacity);return b};KIP.Objects.SVGDrawable.prototype.AssignPoints=function(a,b){};KIP.Objects.SVGDrawable.prototype.AdjustStyle=function(a,b,c){b||(b=this.elementsByID[a]);b&&this.AssignStyle(c,b)};
KIP.Objects.SVGDrawable.prototype.AdjustSize=function(a,b,c){a&&this.w!==a&&(this.w=a||this.w,this.div.setAttribute("width",this.w));b&&this.h!==b&&(this.h=b||this.h,this.div.setAttribute("height",this.h));if(c&&this.view!==c||!this.view)this.view=c||this.CalculateView(),this.div.setAttribute("viewBox",this.view)};KIP.Objects.SVGDrawable.prototype.GetElement=function(a){return this.elementsByID[a]};KIP.Objects.SVGDrawable.prototype.CreateGradient=function(a,b){};
KIP.Objects.SVGDrawable.prototype.CreateGroup=function(a){return this.AddChild("g",[],{},a)};KIP.Objects.SVGDrawable.prototype.SetAttribute=function(a,b){this.div.setAttribute(a,b)};KIP.Objects.SVGDrawable.prototype.Clear=function(){var a,b;for(b=this.div.children.length-1;1<=b;--b)a=this.div.children[b],this.div.removeChild(a)};KIP.Objects.Select=function(a){KIP.Objects.Drawable.call(this,a,"select");this.id=a;this.input=KIP.Functions.CreateElement({type:"input",cls:"select",id:"input"+a});this.data=[];this.dataDiv=KIP.Functions.CreateSimpleElement("data"+a,"dropdown");this.selectedData=-1;this.options=[];this.visible=[];this.visibleCnt=0;this.div.appendChild(this.input);this.div.appendChild(this.dataDiv);this.AddListeners()};KIP.Objects.Select.prototype=Object.create(KIP.Objects.Drawable.prototype);
KIP.Objects.Select.prototype.AddListeners=function(){var a;a=this;this.input.addEventListener("focus",function(){a.Dropdown()});this.input.addEventListener("blur",function(){a.Dropdown(!0)});this.input.addEventListener("keydown",function(b){a.expanded&&(40===b.keyCode?a.HiliteNext():38===b.keyCode?a.HilitePrevious():13===b.keyCode&&a.Validate())});this.input.addEventListener("input",function(b){a.Filter();b.stopPropagation();return!1})};
KIP.Objects.Select.prototype.Dropdown=function(a){a?(KIP.Functions.RemoveCSSClass(this.dataDiv,"expanded"),this.expanded=!1):(KIP.Functions.AddCSSClass(this.dataDiv,"expanded"),this.expanded=!0,this.hiliteNext=this.selectedData=0)};
KIP.Objects.Select.prototype.AddData=function(a){var b,c,d,e,f;e=this;d=function(a,b){a.addEventListener("mousedown",function(a){e.Select(e.data[b])})};for(b in a)a.hasOwnProperty(b)&&(f=this.data.push({key:b,val:a[b]}),c=KIP.Functions.CreateSimpleElement("opt"+this.id+"|"+f,"opt",a[b]),this.options.push(c),this.visible.push(!0),this.visibleCnt+=1,d(c,f-1),this.dataDiv.appendChild(c))};
KIP.Objects.Select.prototype.Filter=function(){var a,b,c;b=this.input.value;for(a=0;a<this.data.length;a+=1)c=this.data[a].key.indexOf(b),-1===c&&(c=this.data[a].val.indexOf(b)),-1===c&&this.visible[a]&&(KIP.Functions.AddCSSClass(this.options[a],"filtered"),a===this.selectedData&&(this.selectedData=-1),this.visible[a]=!1,--this.visibleCnt),-1===c||this.visible[a]||(KIP.Functions.RemoveCSSClass(this.options[a],"filtered"),this.visible[a]=!0,this.visibleCnt+=1)};
KIP.Objects.Select.prototype._Hilite=function(a){var b,c,d;if(0!==this.dataDiv.children.length){0<=this.selectedData&&KIP.Functions.RemoveCSSClass(this.options[this.selectedData],"selected");for(c=0;!d;)if(b=this.selectedData+a,0>b&&(b=this.data.length-1),b>=this.data.length&&(b=0),this.visible[b]&&(d=!0),c+=1,c>this.data.length)return;KIP.Functions.AddCSSClass(this.options[b],"selected");this.selectedData=b}};KIP.Objects.Select.prototype.HiliteNext=function(){return this._Hilite(1)};
KIP.Objects.Select.prototype.HilitePrevious=function(){return this._Hilite(-1)};KIP.Objects.Select.prototype.Select=function(a){this.value=a.key;this.input.value=a.val};KIP.Objects.Select.prototype.Validate=function(){var a;a=this.input.value;-1!==this.selectedData&&(0<=this.data[this.selectedData].key.indexOf(a)||0<=this.data[this.selectedData].val.indexOf(a))&&this.select(this.selectedData)};KIP.Objects.Collection=function(){this.data=[];this.backData={}};KIP.Objects.Collection.prototype.Length=function(){return this.data.length};KIP.Objects.Collection.prototype.AddElement=function(a,b,c,d){var e,f;if(this.DoesElementExist(a)){if(!d)return null;this.RemoveElement(a)}b={key:a,value:b};c||0===c?(this.data.splice(c,0,b),e=!0):c=this.data.push(b);this.backData[a]=c;if(e)for(f in this.backData)this.backData.hasOwnProperty(f)&&(e=this.backData[f],e>=c&&f!==a&&(this.backData[f]+=1));return c};
KIP.Objects.Collection.prototype.RemoveElement=function(a,b){var c,d,e;b||0===b||(b=this.GetElementIdx(a));e=this.data.splice(b,1);delete this.backData[a];for(c in this.backData)this.backData.hasOwnProperty(c)&&(d=this.backData[c],d>b&&--this.backData[c]);return{key:a,idx:b,value:e}};KIP.Objects.Collection.prototype.RemoveElementAtIndex=function(a){var b;b=this.GetElementKey(a);return this.RemoveElement(b,a)};
KIP.Objects.Collection.prototype.GetElement=function(a,b){b||0===b||(b=this.GetElementIdx(a));return!b&&0!==b||!this.data[b]&&0!==this.data[b]?null:this.data[b].value};KIP.Objects.Collection.prototype.GetElementByIdx=function(a){var b=this.GetElementKey(a);return this.GetElement(b,a)};KIP.Objects.Collection.prototype.GetElementIdx=function(a){return this.backData[a]};KIP.Objects.Collection.prototype.GetElementKey=function(a){var b=this.data[a];return b||0===b?this.data[a].key:null};
KIP.Objects.Collection.prototype.Sort=function(a){return this.data.sort(a)};KIP.Objects.Collection.prototype.MergeCollection=function(a,b){var c,d,e;for(d=0;d<a.data.length;d+=1)c=a.data[d],this.backData.hasOwnProperty(c)?b||(this.data[this.backData[c]]=a.data[d]):(e=this.data.push(a.data[d]),this.backData[c]=e)};KIP.Objects.Collection.prototype.Clear=function(){this.data=[];this.backData={}};KIP.Objects.Collection.prototype.GetNextIndex=function(){return this.data.length};
KIP.Objects.Collection.prototype.DoesElementExist=function(a){return(a=this.backData[a])||0===a?!!this.data[a]:!1};KIP.Constants.GraphTypeEnum={Pie:0,Bar:1,Circle:2,Tier:3,Line:4,Trend:5};KIP.Objects.Graph=function(a,b){this.id=a;this.data=[];this.dataListeners=[];this.type=b;this.sortedData=[];this.elems=[];KIP.Objects.SVGDrawable.call(this,a)};KIP.Objects.Graph.prototype=Object.create(KIP.Objects.SVGDrawable.prototype);KIP.Objects.Graph.prototype.AddData=function(a,b,c,d,e){var f;f=this.data.length;this.data[f]={lbl:a,x:b,y:c,z:d,extra:e};this.AddDataAppropriateForGraph(f);return f};
KIP.Objects.Graph.prototype.AddDataAppropriateForGraph=function(a){};KIP.Objects.Graph.prototype.AddListenerToData=function(a,b,c){this.dataListeners[a]||(this.dataListeners[a]=[]);this.dataListeners[a][this.dataListeners[a].length]={type:b,listener:c}};KIP.Objects.Graph.prototype.AttachDataListeners=function(a,b){var c,d,e,f;if(d=this.dataListeners[a])for(f=0;f<d.length;f+=1)d[f]&&(c=d[f].type,e=d[f].listener,c&&e&&b.addEventListener(c,e))};
KIP.Objects.CircularGraph=function(a,b){KIP.Objects.Graph.call(this,a,b)};KIP.Objects.CircularGraph.prototype=Object.create(KIP.Objects.Graph.prototype);
KIP.Objects.CircularGraph.prototype.AddTextAroundRing=function(a,b,c,d,e,f,g,h,m){var l,k,n;if(this.radius)return e=e||this.radius,l=KIP.Functions.DegreesToRadians(b+(c-b)/2),k=KIP.Functions.RoundToPlace(-1*Math.cos(l),1E3),l=KIP.Functions.RoundToPlace(Math.sin(l),1E3),n={},n.y=k/-4+.75,n.x=l/-2+.5,a=this.AddText(d,a,this.center.x+l*(e+1),this.center.y+(e+1)*k,this.fontStyle,f,g,n,h),m&&(m=this.MeasureElem(a),a.setAttribute("transform","rotate("+(((c-b)/2+b)%45+315)+" "+(m.x+m.width/2)+" "+(m.y+m.height/
2)+")")),a};KIP.Objects.CircularGraph.prototype.AddPieceListeners=function(a,b,c){a&&b&&(a.addEventListener("mouseover",function(){b.style.opacity=1;c&&(c.style.opacity=.8)}),a.addEventListener("mouseout",function(){b.style.opacity=0;c&&(c.style.opacity=0)}),b.style.transition="opacity ease-in-out .2s",b.style.opacity=0,c&&(c.style.opacity=0,c.style.transition="opacity ease-in-out .2s"))};
KIP.Objects.PieGraph=function(a,b,c,d,e){this.center=b||{x:80,y:80};this.radius=c||30;this.total=0;this.style=d||{stroke:{type:"solid",color:"#000",width:"0px"},fill:{type:"solid"}};this.fontStyle={font:{family:"Segoe UI",size:"10px"},fill:{type:"solid"}};this.hslRotate=KIP.Constants.HSLPieceEnum.Saturation;this.labelAtTop=e||!1;this.sort=!0;this.days=this.keyY=this.keyX=0;this.addKey=this.addLabels=!0;KIP.Objects.CircularGraph.call(this,a,KIP.Constants.GraphTypeEnum.Pie)};
KIP.Objects.PieGraph.prototype=Object.create(KIP.Objects.CircularGraph.prototype);KIP.Objects.PieGraph.prototype.ChooseColorRotate=function(a){this.hslRotate=a};
KIP.Objects.PieGraph.prototype.Refresh=function(){var a,b,c,d,e,f,g,h,m,l,k,n,p,r;g=this.style;e=0;this.Clear();m=this.CreateGroup("wedges");k=this.CreateGroup("boxes");l=this.CreateGroup("text");this.keyOnRadius?(this.keyX=this.center.x+this.radius+5,this.keyY=this.center.y-this.radius+this.gutter):(this.keyX=this.max_x||0,this.keyY=this.min_y);this.sortedArray=this.data.slice();this.sort&&(this.sortedArray=this.sortedArray.sort(function(a,b){return a.x>b.x?-1:a.x<b.x?1:0}));for(p=0;p<this.sortedArray.length;p+=
1)a=this.sortedArray[p],b=a.id,d=a.x/this.total,h=a.y||this.radius,this.fontStyle.fill.color=g.fill.color=KIP.Functions.GenerateColor("",this.hslRotate),c=1===this.data.length?this.AddCircle(this.center.x,this.center.y,h,this.style,"","",m):this.AddPerfectArc(this.center,h,e,e+360*d,1,!1,g,"","",m),this.addLabels&&(this.labelAtTop?(f=this.AddText(c,a.lbl,this.center.x-this.radius,this.center.y-this.radius-16,this.fontStyle,"","","",l),h=this.MeasureElem(f),n=this.AddRectangle(h.x,h.y,h.width,h.height,
{fill:{type:"solid",color:"#FFF"}},"","",k)):f=this.AddTextAroundRing(a.lbl,e,e+360*d,c,h,"","",l,this.rotate)),this.addKey&&(r=this.AddDataToKey(a,l)),this.AddPieceListeners(c,f,n),this.AttachDataListeners(b,c),e+=360*d,this.elems[b]={piece:c,label:f,labelBox:n,color:g.fill.color,keyText:r};this.addKey&&(this.fontStyle.fill.color="#000",this.keyY+=5,this.AddDataToKey({x:this.total,lbl:"TOTAL"},l),this.days&&this.AddDataToKey({x:KIP.Functions.RoundToPlace(this.total/this.days,10),lbl:"Avg Day"},l))};
KIP.Objects.PieGraph.prototype.AddDataToKey=function(a,b){var c,d;c=JSON.parse(JSON.stringify(this.fontStyle));c.font.size="6";c=this.AddText(void 0,a.lbl+" : "+a.x,this.keyX,this.keyY,c,"","","",b);d=this.MeasureElem(c);this.keyY+=d.height;return c};KIP.Objects.PieGraph.prototype.AddDataAppropriateForGraph=function(a){var b;b=this.data[a];this.total+=b.x;b.id=a;this.parent&&this.Draw()};
KIP.Objects.CircleGraph=function(a,b,c,d){this.center=b||{x:80,y:80};this.radius=c||30;this.ringTotals=[];this.style=d||{stroke:{type:"solid",color:"#000",width:"5px"},fill:{}};this.fontStyle={font:{family:"Segoe UI",size:"10px"},fill:{type:"solid"}};this.strokeWidth=5;KIP.Objects.CircularGraph.call(this,a,KIP.Constants.GraphTypeEnum.Circle)};KIP.Objects.CircleGraph.prototype=Object.create(KIP.Objects.CircularGraph.prototype);
KIP.Objects.CircleGraph.prototype.Refresh=function(){var a,b,c,d,e,f,g,h,m,l,k,n,p;n=this.CreateGroup("rings");p=this.CreateGroup("text");d=Math.max.apply(this,this.ringTotals);a={};m=[];for(c=0;c<this.data.length;c+=1)b=this.data[c],a[b.lbl]||(a[b.lbl]=KIP.Functions.GenerateColor(b.lbl,KIP.Constants.HSLPieceEnum.Hue)),e=a[b.lbl],f=b.y,g=b.z*this.strokeWidth,m[f]||(m[f]=0),l=360*b.x/d+m[f],0>f?(f*=-1,k=.4):k=1,h=this.radius+this.radius/2*f,this.style.stroke.width=g+"px",this.style.stroke.color=e,
e=this.AddPerfectArc(this.center,h,m[f],l,1,!0,this.style,"","",n),e.style.opacity=k,b=this.AddTextAroundRing(b.lbl,m[f],l,e,h+(g-this.strokeWidth),"","",p),this.div.appendChild(e),this.AddPieceListeners(e,b),this.AttachDataListeners(c,e),m[f]=l};KIP.Objects.CircleGraph.prototype.AddDataAppropriateForGraph=function(a){var b;b=this.data[a];a=b.y;0>a&&(a*=-1);this.ringTotals[a]||(this.ringTotals[a]=0);this.ringTotals[a]+=b.x;this.parent&&this.Draw()};
KIP.Objects.TrendingGraph=function(a,b,c){this.min_x=b||1E7;this.min_y=c||1E7;this.hslRotate=KIP.Constants.HSLPieceEnum.Hue;this.style={fill:{},stroke:{type:"solid",width:"0.2"},font:{family:"Calibri"}};this.fontStyle={fill:{type:"solid"},font:{family:"Calibri"}};KIP.Objects.Graph.call(this,a,KIP.Constants.GraphTypeEnum.Trend)};KIP.Objects.TrendingGraph.prototype=Object.create(KIP.Objects.Graph.prototype);
KIP.Objects.TrendingGraph.prototype.AddDataAppropriateForGraph=function(a){a=this.data[a];this.UpdateView(a.x,a.y,1,1)};KIP.Objects.TrendingGraph.prototype.AddLineListeners=function(a,b,c){var d=this;a&&b&&(a.addEventListener("mouseover",function(){b.style.opacity=1;a.style.strokeWidth=3*d.style.stroke.width+"px";c&&(c.style.opacity=.8)}),a.addEventListener("mouseout",function(){b.style.opacity=0;a.style.strokeWidth=d.style.stroke.width+"px";c&&(c.style.opacity=0)}),b.style.opacity=0)};
KIP.Objects.TrendingGraph.prototype.Refresh=function(){var a,b,c,d,e,f,g,h;b=this.data.slice();b=b.sort(function(a,b){return a&&b&&void 0!==a.z&&void 0!==b.z?a.z>b.z?1:a.z<b.z?-1:a.x>b.x?1:a.x<b.x?-1:0:0});this.style.stroke.width=Math.min(this.max_x-this.min_x,this.max_y-this.min_y)/70;this.fontStyle.font.size=8*this.style.stroke.width;e=this.CreateGroup("pts");f=this.CreateGroup("txt");for(d=0;d<b.length;d+=1)a=b[d],void 0===a.z&&!g||c!==a.z?(this.fontStyle.fill.color=this.style.stroke.color=KIP.Functions.GenerateColor("",
this.hslRotate),void 0!==a.z&&(c=a.z),g=this.AddChild("path",{d:""},this.style,"","",e),h=this.AddText(g,a.lbl,a.x,a.y,this.fontStyle,"","","",f),this.AddLineListeners(g,h),this.MoveTo(a.x,a.y,g)):this.LineTo(a.x,a.y,g)};